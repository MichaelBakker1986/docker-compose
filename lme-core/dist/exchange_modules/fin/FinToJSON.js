'use strict';

var cov_29c2dnqlla = function () {
    var path = 'C:\\Users\\michael\\Documents\\lme\\lme-core\\exchange_modules\\fin\\FinToJSON.js',
        hash = '75cda8737dda24a8a3698ca0b754a203eb92e2ad',
        Function = function () {}.constructor,
        global = new Function('return this')(),
        gcv = '__coverage__',
        coverageData = {
        path: 'C:\\Users\\michael\\Documents\\lme\\lme-core\\exchange_modules\\fin\\FinToJSON.js',
        statementMap: {
            '0': {
                start: {
                    line: 4,
                    column: 13
                },
                end: {
                    line: 4,
                    column: 30
                }
            },
            '1': {
                start: {
                    line: 5,
                    column: 12
                },
                end: {
                    line: 5,
                    column: 27
                }
            },
            '2': {
                start: {
                    line: 6,
                    column: 17
                },
                end: {
                    line: 6,
                    column: 45
                }
            },
            '3': {
                start: {
                    line: 32,
                    column: 15
                },
                end: {
                    line: 54,
                    column: 1
                }
            },
            '4': {
                start: {
                    line: 55,
                    column: 0
                },
                end: {
                    line: 141,
                    column: 1
                }
            },
            '5': {
                start: {
                    line: 79,
                    column: 8
                },
                end: {
                    line: 91,
                    column: 9
                }
            },
            '6': {
                start: {
                    line: 82,
                    column: 31
                },
                end: {
                    line: 82,
                    column: 72
                }
            },
            '7': {
                start: {
                    line: 83,
                    column: 12
                },
                end: {
                    line: 86,
                    column: 13
                }
            },
            '8': {
                start: {
                    line: 85,
                    column: 16
                },
                end: {
                    line: 85,
                    column: 53
                }
            },
            '9': {
                start: {
                    line: 90,
                    column: 12
                },
                end: {
                    line: 90,
                    column: 53
                }
            },
            '10': {
                start: {
                    line: 97,
                    column: 8
                },
                end: {
                    line: 97,
                    column: 31
                }
            },
            '11': {
                start: {
                    line: 98,
                    column: 8
                },
                end: {
                    line: 98,
                    column: 64
                }
            },
            '12': {
                start: {
                    line: 102,
                    column: 8
                },
                end: {
                    line: 102,
                    column: 30
                }
            },
            '13': {
                start: {
                    line: 104,
                    column: 8
                },
                end: {
                    line: 104,
                    column: 64
                }
            },
            '14': {
                start: {
                    line: 107,
                    column: 8
                },
                end: {
                    line: 107,
                    column: 78
                }
            },
            '15': {
                start: {
                    line: 111,
                    column: 8
                },
                end: {
                    line: 111,
                    column: 33
                }
            },
            '16': {
                start: {
                    line: 113,
                    column: 8
                },
                end: {
                    line: 113,
                    column: 56
                }
            },
            '17': {
                start: {
                    line: 117,
                    column: 8
                },
                end: {
                    line: 117,
                    column: 33
                }
            },
            '18': {
                start: {
                    line: 118,
                    column: 8
                },
                end: {
                    line: 118,
                    column: 64
                }
            },
            '19': {
                start: {
                    line: 122,
                    column: 8
                },
                end: {
                    line: 122,
                    column: 34
                }
            },
            '20': {
                start: {
                    line: 123,
                    column: 8
                },
                end: {
                    line: 123,
                    column: 64
                }
            },
            '21': {
                start: {
                    line: 127,
                    column: 8
                },
                end: {
                    line: 127,
                    column: 32
                }
            },
            '22': {
                start: {
                    line: 128,
                    column: 8
                },
                end: {
                    line: 128,
                    column: 64
                }
            },
            '23': {
                start: {
                    line: 135,
                    column: 8
                },
                end: {
                    line: 138,
                    column: 9
                }
            },
            '24': {
                start: {
                    line: 137,
                    column: 12
                },
                end: {
                    line: 137,
                    column: 33
                }
            },
            '25': {
                start: {
                    line: 139,
                    column: 8
                },
                end: {
                    line: 139,
                    column: 74
                }
            },
            '26': {
                start: {
                    line: 146,
                    column: 4
                },
                end: {
                    line: 299,
                    column: 5
                }
            },
            '27': {
                start: {
                    line: 150,
                    column: 8
                },
                end: {
                    line: 150,
                    column: 40
                }
            },
            '28': {
                start: {
                    line: 152,
                    column: 8
                },
                end: {
                    line: 152,
                    column: 40
                }
            },
            '29': {
                start: {
                    line: 157,
                    column: 8
                },
                end: {
                    line: 157,
                    column: 58
                }
            },
            '30': {
                start: {
                    line: 160,
                    column: 8
                },
                end: {
                    line: 160,
                    column: 41
                }
            },
            '31': {
                start: {
                    line: 161,
                    column: 8
                },
                end: {
                    line: 161,
                    column: 41
                }
            },
            '32': {
                start: {
                    line: 169,
                    column: 8
                },
                end: {
                    line: 169,
                    column: 57
                }
            },
            '33': {
                start: {
                    line: 170,
                    column: 8
                },
                end: {
                    line: 170,
                    column: 47
                }
            },
            '34': {
                start: {
                    line: 171,
                    column: 8
                },
                end: {
                    line: 171,
                    column: 47
                }
            },
            '35': {
                start: {
                    line: 176,
                    column: 8
                },
                end: {
                    line: 176,
                    column: 44
                }
            },
            '36': {
                start: {
                    line: 178,
                    column: 8
                },
                end: {
                    line: 178,
                    column: 41
                }
            },
            '37': {
                start: {
                    line: 185,
                    column: 8
                },
                end: {
                    line: 194,
                    column: 43
                }
            },
            '38': {
                start: {
                    line: 198,
                    column: 8
                },
                end: {
                    line: 198,
                    column: 178
                }
            },
            '39': {
                start: {
                    line: 201,
                    column: 8
                },
                end: {
                    line: 201,
                    column: 128
                }
            },
            '40': {
                start: {
                    line: 203,
                    column: 8
                },
                end: {
                    line: 203,
                    column: 129
                }
            },
            '41': {
                start: {
                    line: 206,
                    column: 8
                },
                end: {
                    line: 206,
                    column: 148
                }
            },
            '42': {
                start: {
                    line: 210,
                    column: 8
                },
                end: {
                    line: 210,
                    column: 109
                }
            },
            '43': {
                start: {
                    line: 213,
                    column: 8
                },
                end: {
                    line: 213,
                    column: 45
                }
            },
            '44': {
                start: {
                    line: 215,
                    column: 19
                },
                end: {
                    line: 215,
                    column: 46
                }
            },
            '45': {
                start: {
                    line: 216,
                    column: 8
                },
                end: {
                    line: 216,
                    column: 24
                }
            },
            '46': {
                start: {
                    line: 227,
                    column: 23
                },
                end: {
                    line: 227,
                    column: 25
                }
            },
            '47': {
                start: {
                    line: 228,
                    column: 28
                },
                end: {
                    line: 231,
                    column: 9
                }
            },
            '48': {
                start: {
                    line: 233,
                    column: 20
                },
                end: {
                    line: 237,
                    column: 9
                }
            },
            '49': {
                start: {
                    line: 238,
                    column: 26
                },
                end: {
                    line: 238,
                    column: 28
                }
            },
            '50': {
                start: {
                    line: 239,
                    column: 8
                },
                end: {
                    line: 291,
                    column: 9
                }
            },
            '51': {
                start: {
                    line: 244,
                    column: 22
                },
                end: {
                    line: 244,
                    column: 29
                }
            },
            '52': {
                start: {
                    line: 246,
                    column: 12
                },
                end: {
                    line: 290,
                    column: 13
                }
            },
            '53': {
                start: {
                    line: 248,
                    column: 16
                },
                end: {
                    line: 255,
                    column: 17
                }
            },
            '54': {
                start: {
                    line: 250,
                    column: 20
                },
                end: {
                    line: 250,
                    column: 38
                }
            },
            '55': {
                start: {
                    line: 254,
                    column: 20
                },
                end: {
                    line: 254,
                    column: 32
                }
            },
            '56': {
                start: {
                    line: 257,
                    column: 17
                },
                end: {
                    line: 290,
                    column: 13
                }
            },
            '57': {
                start: {
                    line: 259,
                    column: 30
                },
                end: {
                    line: 259,
                    column: 89
                }
            },
            '58': {
                start: {
                    line: 260,
                    column: 16
                },
                end: {
                    line: 267,
                    column: 17
                }
            },
            '59': {
                start: {
                    line: 262,
                    column: 20
                },
                end: {
                    line: 262,
                    column: 50
                }
            },
            '60': {
                start: {
                    line: 266,
                    column: 20
                },
                end: {
                    line: 266,
                    column: 52
                }
            },
            '61': {
                start: {
                    line: 272,
                    column: 16
                },
                end: {
                    line: 272,
                    column: 46
                }
            },
            '62': {
                start: {
                    line: 275,
                    column: 16
                },
                end: {
                    line: 275,
                    column: 51
                }
            },
            '63': {
                start: {
                    line: 277,
                    column: 30
                },
                end: {
                    line: 277,
                    column: 92
                }
            },
            '64': {
                start: {
                    line: 279,
                    column: 16
                },
                end: {
                    line: 283,
                    column: 17
                }
            },
            '65': {
                start: {
                    line: 281,
                    column: 20
                },
                end: {
                    line: 281,
                    column: 125
                }
            },
            '66': {
                start: {
                    line: 282,
                    column: 20
                },
                end: {
                    line: 282,
                    column: 29
                }
            },
            '67': {
                start: {
                    line: 284,
                    column: 16
                },
                end: {
                    line: 284,
                    column: 46
                }
            },
            '68': {
                start: {
                    line: 285,
                    column: 16
                },
                end: {
                    line: 288,
                    column: 17
                }
            },
            '69': {
                start: {
                    line: 287,
                    column: 20
                },
                end: {
                    line: 287,
                    column: 37
                }
            },
            '70': {
                start: {
                    line: 289,
                    column: 16
                },
                end: {
                    line: 289,
                    column: 38
                }
            },
            '71': {
                start: {
                    line: 293,
                    column: 8
                },
                end: {
                    line: 298,
                    column: 9
                }
            },
            '72': {
                start: {
                    line: 295,
                    column: 12
                },
                end: {
                    line: 295,
                    column: 33
                }
            },
            '73': {
                start: {
                    line: 296,
                    column: 12
                },
                end: {
                    line: 296,
                    column: 51
                }
            },
            '74': {
                start: {
                    line: 297,
                    column: 12
                },
                end: {
                    line: 297,
                    column: 34
                }
            },
            '75': {
                start: {
                    line: 301,
                    column: 4
                },
                end: {
                    line: 301,
                    column: 20
                }
            },
            '76': {
                start: {
                    line: 303,
                    column: 0
                },
                end: {
                    line: 305,
                    column: 1
                }
            }
        },
        fnMap: {
            '0': {
                name: '(anonymous_0)',
                decl: {
                    start: {
                        line: 56,
                        column: 14
                    },
                    end: {
                        line: 56,
                        column: 15
                    }
                },
                loc: {
                    start: {
                        line: 57,
                        column: 4
                    },
                    end: {
                        line: 59,
                        column: 5
                    }
                },
                line: 57
            },
            '1': {
                name: '(anonymous_1)',
                decl: {
                    start: {
                        line: 60,
                        column: 15
                    },
                    end: {
                        line: 60,
                        column: 16
                    }
                },
                loc: {
                    start: {
                        line: 61,
                        column: 4
                    },
                    end: {
                        line: 62,
                        column: 5
                    }
                },
                line: 61
            },
            '2': {
                name: '(anonymous_2)',
                decl: {
                    start: {
                        line: 63,
                        column: 14
                    },
                    end: {
                        line: 63,
                        column: 15
                    }
                },
                loc: {
                    start: {
                        line: 64,
                        column: 4
                    },
                    end: {
                        line: 66,
                        column: 5
                    }
                },
                line: 64
            },
            '3': {
                name: '(anonymous_3)',
                decl: {
                    start: {
                        line: 67,
                        column: 16
                    },
                    end: {
                        line: 67,
                        column: 17
                    }
                },
                loc: {
                    start: {
                        line: 68,
                        column: 4
                    },
                    end: {
                        line: 70,
                        column: 5
                    }
                },
                line: 68
            },
            '4': {
                name: '(anonymous_4)',
                decl: {
                    start: {
                        line: 71,
                        column: 10
                    },
                    end: {
                        line: 71,
                        column: 11
                    }
                },
                loc: {
                    start: {
                        line: 72,
                        column: 4
                    },
                    end: {
                        line: 74,
                        column: 5
                    }
                },
                line: 72
            },
            '5': {
                name: '(anonymous_5)',
                decl: {
                    start: {
                        line: 75,
                        column: 13
                    },
                    end: {
                        line: 75,
                        column: 14
                    }
                },
                loc: {
                    start: {
                        line: 76,
                        column: 4
                    },
                    end: {
                        line: 92,
                        column: 5
                    }
                },
                line: 76
            },
            '6': {
                name: '(anonymous_6)',
                decl: {
                    start: {
                        line: 95,
                        column: 14
                    },
                    end: {
                        line: 95,
                        column: 15
                    }
                },
                loc: {
                    start: {
                        line: 96,
                        column: 4
                    },
                    end: {
                        line: 99,
                        column: 5
                    }
                },
                line: 96
            },
            '7': {
                name: '(anonymous_7)',
                decl: {
                    start: {
                        line: 100,
                        column: 11
                    },
                    end: {
                        line: 100,
                        column: 12
                    }
                },
                loc: {
                    start: {
                        line: 101,
                        column: 4
                    },
                    end: {
                        line: 108,
                        column: 5
                    }
                },
                line: 101
            },
            '8': {
                name: '(anonymous_8)',
                decl: {
                    start: {
                        line: 109,
                        column: 13
                    },
                    end: {
                        line: 109,
                        column: 14
                    }
                },
                loc: {
                    start: {
                        line: 110,
                        column: 4
                    },
                    end: {
                        line: 114,
                        column: 5
                    }
                },
                line: 110
            },
            '9': {
                name: '(anonymous_9)',
                decl: {
                    start: {
                        line: 115,
                        column: 13
                    },
                    end: {
                        line: 115,
                        column: 14
                    }
                },
                loc: {
                    start: {
                        line: 116,
                        column: 4
                    },
                    end: {
                        line: 119,
                        column: 5
                    }
                },
                line: 116
            },
            '10': {
                name: '(anonymous_10)',
                decl: {
                    start: {
                        line: 120,
                        column: 19
                    },
                    end: {
                        line: 120,
                        column: 20
                    }
                },
                loc: {
                    start: {
                        line: 121,
                        column: 4
                    },
                    end: {
                        line: 124,
                        column: 5
                    }
                },
                line: 121
            },
            '11': {
                name: '(anonymous_11)',
                decl: {
                    start: {
                        line: 125,
                        column: 12
                    },
                    end: {
                        line: 125,
                        column: 13
                    }
                },
                loc: {
                    start: {
                        line: 126,
                        column: 4
                    },
                    end: {
                        line: 129,
                        column: 5
                    }
                },
                line: 126
            },
            '12': {
                name: '(anonymous_12)',
                decl: {
                    start: {
                        line: 130,
                        column: 15
                    },
                    end: {
                        line: 130,
                        column: 16
                    }
                },
                loc: {
                    start: {
                        line: 131,
                        column: 4
                    },
                    end: {
                        line: 140,
                        column: 5
                    }
                },
                line: 131
            },
            '13': {
                name: 'parseFinFile',
                decl: {
                    start: {
                        line: 144,
                        column: 9
                    },
                    end: {
                        line: 144,
                        column: 21
                    }
                },
                loc: {
                    start: {
                        line: 145,
                        column: 0
                    },
                    end: {
                        line: 302,
                        column: 1
                    }
                },
                line: 145
            }
        },
        branchMap: {
            '0': {
                loc: {
                    start: {
                        line: 79,
                        column: 8
                    },
                    end: {
                        line: 91,
                        column: 9
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 79,
                        column: 8
                    },
                    end: {
                        line: 91,
                        column: 9
                    }
                }, {
                    start: {
                        line: 79,
                        column: 8
                    },
                    end: {
                        line: 91,
                        column: 9
                    }
                }],
                line: 79
            },
            '1': {
                loc: {
                    start: {
                        line: 83,
                        column: 12
                    },
                    end: {
                        line: 86,
                        column: 13
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 83,
                        column: 12
                    },
                    end: {
                        line: 86,
                        column: 13
                    }
                }, {
                    start: {
                        line: 83,
                        column: 12
                    },
                    end: {
                        line: 86,
                        column: 13
                    }
                }],
                line: 83
            },
            '2': {
                loc: {
                    start: {
                        line: 135,
                        column: 8
                    },
                    end: {
                        line: 138,
                        column: 9
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 135,
                        column: 8
                    },
                    end: {
                        line: 138,
                        column: 9
                    }
                }, {
                    start: {
                        line: 135,
                        column: 8
                    },
                    end: {
                        line: 138,
                        column: 9
                    }
                }],
                line: 135
            },
            '3': {
                loc: {
                    start: {
                        line: 146,
                        column: 4
                    },
                    end: {
                        line: 299,
                        column: 5
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 146,
                        column: 4
                    },
                    end: {
                        line: 299,
                        column: 5
                    }
                }, {
                    start: {
                        line: 146,
                        column: 4
                    },
                    end: {
                        line: 299,
                        column: 5
                    }
                }],
                line: 146
            },
            '4': {
                loc: {
                    start: {
                        line: 246,
                        column: 12
                    },
                    end: {
                        line: 290,
                        column: 13
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 246,
                        column: 12
                    },
                    end: {
                        line: 290,
                        column: 13
                    }
                }, {
                    start: {
                        line: 246,
                        column: 12
                    },
                    end: {
                        line: 290,
                        column: 13
                    }
                }],
                line: 246
            },
            '5': {
                loc: {
                    start: {
                        line: 248,
                        column: 16
                    },
                    end: {
                        line: 255,
                        column: 17
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 248,
                        column: 16
                    },
                    end: {
                        line: 255,
                        column: 17
                    }
                }, {
                    start: {
                        line: 248,
                        column: 16
                    },
                    end: {
                        line: 255,
                        column: 17
                    }
                }],
                line: 248
            },
            '6': {
                loc: {
                    start: {
                        line: 257,
                        column: 17
                    },
                    end: {
                        line: 290,
                        column: 13
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 257,
                        column: 17
                    },
                    end: {
                        line: 290,
                        column: 13
                    }
                }, {
                    start: {
                        line: 257,
                        column: 17
                    },
                    end: {
                        line: 290,
                        column: 13
                    }
                }],
                line: 257
            },
            '7': {
                loc: {
                    start: {
                        line: 259,
                        column: 30
                    },
                    end: {
                        line: 259,
                        column: 89
                    }
                },
                type: 'cond-expr',
                locations: [{
                    start: {
                        line: 259,
                        column: 55
                    },
                    end: {
                        line: 259,
                        column: 64
                    }
                }, {
                    start: {
                        line: 259,
                        column: 67
                    },
                    end: {
                        line: 259,
                        column: 89
                    }
                }],
                line: 259
            },
            '8': {
                loc: {
                    start: {
                        line: 260,
                        column: 16
                    },
                    end: {
                        line: 267,
                        column: 17
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 260,
                        column: 16
                    },
                    end: {
                        line: 267,
                        column: 17
                    }
                }, {
                    start: {
                        line: 260,
                        column: 16
                    },
                    end: {
                        line: 267,
                        column: 17
                    }
                }],
                line: 260
            },
            '9': {
                loc: {
                    start: {
                        line: 277,
                        column: 31
                    },
                    end: {
                        line: 277,
                        column: 77
                    }
                },
                type: 'binary-expr',
                locations: [{
                    start: {
                        line: 277,
                        column: 31
                    },
                    end: {
                        line: 277,
                        column: 43
                    }
                }, {
                    start: {
                        line: 277,
                        column: 47
                    },
                    end: {
                        line: 277,
                        column: 63
                    }
                }, {
                    start: {
                        line: 277,
                        column: 67
                    },
                    end: {
                        line: 277,
                        column: 77
                    }
                }],
                line: 277
            },
            '10': {
                loc: {
                    start: {
                        line: 279,
                        column: 16
                    },
                    end: {
                        line: 283,
                        column: 17
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 279,
                        column: 16
                    },
                    end: {
                        line: 283,
                        column: 17
                    }
                }, {
                    start: {
                        line: 279,
                        column: 16
                    },
                    end: {
                        line: 283,
                        column: 17
                    }
                }],
                line: 279
            },
            '11': {
                loc: {
                    start: {
                        line: 285,
                        column: 16
                    },
                    end: {
                        line: 288,
                        column: 17
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 285,
                        column: 16
                    },
                    end: {
                        line: 288,
                        column: 17
                    }
                }, {
                    start: {
                        line: 285,
                        column: 16
                    },
                    end: {
                        line: 288,
                        column: 17
                    }
                }],
                line: 285
            },
            '12': {
                loc: {
                    start: {
                        line: 293,
                        column: 8
                    },
                    end: {
                        line: 298,
                        column: 9
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 293,
                        column: 8
                    },
                    end: {
                        line: 298,
                        column: 9
                    }
                }, {
                    start: {
                        line: 293,
                        column: 8
                    },
                    end: {
                        line: 298,
                        column: 9
                    }
                }],
                line: 293
            }
        },
        s: {
            '0': 0,
            '1': 0,
            '2': 0,
            '3': 0,
            '4': 0,
            '5': 0,
            '6': 0,
            '7': 0,
            '8': 0,
            '9': 0,
            '10': 0,
            '11': 0,
            '12': 0,
            '13': 0,
            '14': 0,
            '15': 0,
            '16': 0,
            '17': 0,
            '18': 0,
            '19': 0,
            '20': 0,
            '21': 0,
            '22': 0,
            '23': 0,
            '24': 0,
            '25': 0,
            '26': 0,
            '27': 0,
            '28': 0,
            '29': 0,
            '30': 0,
            '31': 0,
            '32': 0,
            '33': 0,
            '34': 0,
            '35': 0,
            '36': 0,
            '37': 0,
            '38': 0,
            '39': 0,
            '40': 0,
            '41': 0,
            '42': 0,
            '43': 0,
            '44': 0,
            '45': 0,
            '46': 0,
            '47': 0,
            '48': 0,
            '49': 0,
            '50': 0,
            '51': 0,
            '52': 0,
            '53': 0,
            '54': 0,
            '55': 0,
            '56': 0,
            '57': 0,
            '58': 0,
            '59': 0,
            '60': 0,
            '61': 0,
            '62': 0,
            '63': 0,
            '64': 0,
            '65': 0,
            '66': 0,
            '67': 0,
            '68': 0,
            '69': 0,
            '70': 0,
            '71': 0,
            '72': 0,
            '73': 0,
            '74': 0,
            '75': 0,
            '76': 0
        },
        f: {
            '0': 0,
            '1': 0,
            '2': 0,
            '3': 0,
            '4': 0,
            '5': 0,
            '6': 0,
            '7': 0,
            '8': 0,
            '9': 0,
            '10': 0,
            '11': 0,
            '12': 0,
            '13': 0
        },
        b: {
            '0': [0, 0],
            '1': [0, 0],
            '2': [0, 0],
            '3': [0, 0],
            '4': [0, 0],
            '5': [0, 0],
            '6': [0, 0],
            '7': [0, 0],
            '8': [0, 0],
            '9': [0, 0, 0],
            '10': [0, 0],
            '11': [0, 0],
            '12': [0, 0]
        },
        _coverageSchema: 'd34fc3e6b8297bcde183f5492bcb8fcb36775295'
    },
        coverage = global[gcv] || (global[gcv] = {});

    if (coverage[path] && coverage[path].hash === hash) {
        return coverage[path];
    }

    coverageData.hash = hash;
    return coverage[path] = coverageData;
}();

/**
 * We might actually need the fin->ffl/lme parser since the main fin language is .fin
 */
var assert = (cov_29c2dnqlla.s[0]++, require('assert'));
var log = (cov_29c2dnqlla.s[1]++, require('log6'));
var finFormula = (cov_29c2dnqlla.s[2]++, require('../ffl/FinFormula'));
//Attempt3
//the king of regulars, its very simple actually, just get scope all needed information
//first 2 char are P or I
//next 2 P,I or X or ' '
//followed with 11 chars //undefined yet
//followed with the depth flag
//11 more chars //undefined
//non-greedy not [a-z] followed with [a-z]* all of them, to get the variable name
//can't be done easier, sometimes no title, some times a hint
//last chars is for the repeating group, it will repeat when find [PI]2 followed with [PIX ]2
//$1 : varable name
//$2 : metadata
//  regex: /;?([PIX]{2}[PIX ]{2}.{11}(.{1}).{11}.*?(?!:[a-z0-9_])([a-z0-9_]* );.*!?(?:[PIX]{2}[PIX ]{2})*)/gmi,
//and its done

/*{"name":"OtherNegativeMutationsNetWorth","formula":"MutCalc*Max(-BalanceCurrentAccount+BeginningBalanceCurrentAccount+VSUM(@LiquidReceipts,OtherLiquidReceipts$P)+VSum(@OtherLiquidReceipts,OtherPositiveMutationsNetWorth$P)-VSUM(@LiquidExpenses,OtherLiquidExpenses$P)                            -VSum(@OtherLiquidExpenses,OtherNegativeMutationsNetWorth$P),NA)","_contextmeta":"","property":"value"}
 editor.js:16539 2016-08-07T02:11:52+0200 <log> editor.js:22460 (createFormulaSafe) cannot parse: {"name":"OtherPositiveMutationsNetWorth","formula":"MutCalc*Max( BalanceCurrentAccount-BeginningBalanceCurrentAccount-VSUM(@LiquidReceipts,OtherLiquidReceipts$P)                       -VSum(@OtherLiquidReceipts,OtherPositiveMutationsNetWorth$P)+VSUM(@LiquidExpenses,OtherLiquidExpenses$P)+VSum(@OtherLiquidExpenses,OtherNegativeMutationsNetWorth$P),NA)","_contextmeta":"","property":"value"}
 editor.js:16539 2016-08-07T02:11:52+0200 <log> editor.js:22460 (createFormulaSafe) cannot parse: {"name":"DefaultInterestRate","formula":"10%","_contextmeta":"","property":"value"}
 editor.js:16539 2016-08-07T02:11:52+0200 <log> editor.js:22460 (createFormulaSafe) cannot parse: {"name":"DefaultPriceIndex","formula":"OnERorNA(OnZero(Case(DateToYear(LastDateInT),[#$CPI_list#]),NA)/Case(DateToYear(LastDateInT(FirstTinFormulaSet(Notrend,MainPeriod))),[#$CPI_list#])*100,If(T==FirstTinFormulaSet(Notrend,MainPeriod),100,If(FirstTinYear==T, Self[T-1]*(1+DefaultPriceIncreaseTrend), Self[T-1])))","_contextmeta":"","property":"value"}
 editor.js:16539 2016-08-07T02:11:52+0200 <log> editor.js:22460 (createFormulaSafe) cannot parse: {"name":"DefaultWagesIndex","formula":"OnERorNA(OnZero(Case(DateToYear(LastDateInT),[#$CAO_list#]),NA)/Case(DateToYear(LastDateInT(FirstTinFormulaSet(Notrend,MainPeriod))),[#$CAO_list#])*100,If(T==FirstTinFormulaSet(Notrend,MainPeriod),100,If(FirstTinYear==T, Self[T-1]*(1+DefaultWagesIncreaseTrend), Self[T-1])))","_contextmeta":"","property":"value"}*/

//here we only extract data into another flow, not parsing formulas
//function ($0, $1) { return $1 ? $0 : '[match]'; })
//only for formula types,
//share this with bracketparser
var timeRefs = (cov_29c2dnqlla.s[3]++, {
    '[T-1]': '', //previous column reference
    'LastTinFormulaSet(Notrend,MainPeriod)': '', //NoTrend >lastColumn,hoofdtijdlijn
    '[GetT(T,-TsY,0,TsY)]': '', //-1year first column?
    'FirstTinFormulaset(Trend)': '', //Trend > first column
    '[GetT(T, -1, 1, 1)]': '', //
    'FormulasetInT(GetT(T,-1)': '',
    '[LastTinYear,FesExpression(DocumentTsY)]': '',
    'FirstTinFormulaset(Trend,PeriodinT)': '',
    'LastTinYear(T-TsY)': '',
    '[MaxValueT(CapitalShortfall,FirstTinYear,LastTinYear)]': '',
    'FirstTinformulaset(Trend,PeriodInT)': '',
    'LastTinFormulaSet(NoTrend)': '',
    '[LastTinFormulaSet(NoTrend)]': '',
    'FormulaSetInT(T-1)': '',
    'TsY': '', //DocumentTsY
    'TsY(?)': '',
    'FirstTInFormulaset(Trend)': '',
    '[LastTinPeriod]': '',
    '[LastTinFormulaSet(NoTrend),1]': '',
    'FirstTinformulaset(Trend)': '',
    'firstTinFormulaSet(NoTrend)': ''
});
cov_29c2dnqlla.s[4]++;
types = {
    fesevent: function fesevent(solution, obj) {
        cov_29c2dnqlla.f[0]++;
    },
    templates: function templates(solution, obj) {
        cov_29c2dnqlla.f[1]++;
    },
    language: function language(solution, obj) {
        //nothing for now

        cov_29c2dnqlla.f[2]++;
    },
    tryinclude: function tryinclude(solution, obj) {
        //nothing for now

        cov_29c2dnqlla.f[3]++;
    },
    quit: function quit(solution, obj) {
        //nothing for now

        cov_29c2dnqlla.f[4]++;
    },
    unknown: function unknown(solution, obj) {
        cov_29c2dnqlla.f[5]++;
        cov_29c2dnqlla.s[5]++;

        //no solid way to extract the modelname
        //using first unknown type after .Language context
        if (solution.solutionName == undefined) {
            cov_29c2dnqlla.b[0][0]++;

            //don't allow spaces in solution name
            var solutionName = (cov_29c2dnqlla.s[6]++, obj.data.replace(/ /gm, "").toUpperCase());
            cov_29c2dnqlla.s[7]++;
            if (solutionName !== '') {
                cov_29c2dnqlla.b[1][0]++;
                cov_29c2dnqlla.s[8]++;

                solution.solutionName = solutionName;
            } else {
                cov_29c2dnqlla.b[1][1]++;
            }
        } else {
            cov_29c2dnqlla.b[0][1]++;
            cov_29c2dnqlla.s[9]++;

            log.info('Warn:  ' + JSON.stringify(obj));
        }
    },
    //there is soo many pattern, we can do this easier later.
    //throwing all away, just keeping a mapping of some kind
    formulas: function formulas(solution, obj) {
        cov_29c2dnqlla.f[6]++;
        cov_29c2dnqlla.s[10]++;

        obj.property = 'value';
        cov_29c2dnqlla.s[11]++;
        obj.formula = finFormula.finFormulaGeneric(obj.formula);
    },
    hints: function hints(solution, obj) {
        cov_29c2dnqlla.f[7]++;
        cov_29c2dnqlla.s[12]++;

        obj.property = 'hint';
        //   obj.property = 'hint';
        cov_29c2dnqlla.s[13]++;
        obj.formula = finFormula.finFormulaGeneric(obj.formula);
        //Hints are always interpreted as String, they don't add qoutes in the fin language
        //ensure its a quoted
        cov_29c2dnqlla.s[14]++;
        obj.formula = "'" + obj.formula.replace(/["'](.*)["']/gm, "$1") + "'";
    },
    choices: function choices(solution, obj) {
        cov_29c2dnqlla.f[8]++;
        cov_29c2dnqlla.s[15]++;

        obj.property = 'choices';
        // obj.property = 'choices';
        cov_29c2dnqlla.s[16]++;
        obj.formula = finFormula.finChoice(obj.formula);
    },
    visible: function visible(solution, obj) {
        cov_29c2dnqlla.f[9]++;
        cov_29c2dnqlla.s[17]++;

        obj.property = 'visible';
        cov_29c2dnqlla.s[18]++;
        obj.formula = finFormula.finFormulaGeneric(obj.formula);
    },
    inputrequired: function inputrequired(solution, obj) {
        cov_29c2dnqlla.f[10]++;
        cov_29c2dnqlla.s[19]++;

        obj.property = 'required';
        cov_29c2dnqlla.s[20]++;
        obj.formula = finFormula.finFormulaGeneric(obj.formula);
    },
    locked: function locked(solution, obj) {
        cov_29c2dnqlla.f[11]++;
        cov_29c2dnqlla.s[21]++;

        obj.property = 'locked';
        cov_29c2dnqlla.s[22]++;
        obj.formula = finFormula.finFormulaGeneric(obj.formula);
    },
    variables: function variables(solution, obj) {
        cov_29c2dnqlla.f[12]++;
        cov_29c2dnqlla.s[23]++;

        //obj.property = 'formula';
        //a variable can have some formula
        //hint,visible,locked,title
        if (obj.title === undefined) {
            cov_29c2dnqlla.b[2][0]++;
            cov_29c2dnqlla.s[24]++;

            log.info('>>' + obj);
        } else {
            cov_29c2dnqlla.b[2][1]++;
        }
        cov_29c2dnqlla.s[25]++;
        obj.title = "'" + obj.title.replace(/["'](.*)["']/gm, "$1") + "'";
    }

    //the additional regexes will be enormous.
};function parseFinFile(buf) {
    cov_29c2dnqlla.f[13]++;
    cov_29c2dnqlla.s[26]++;

    if (buf.length !== 0) {
        cov_29c2dnqlla.b[3][0]++;
        cov_29c2dnqlla.s[27]++;

        //cant change too much here,
        //but removing large chunks, like comments, empty lines will speed up the rest.
        buf = buf.replace(/;.*$/gm, ''); //remove commented lines and commented appendings

        cov_29c2dnqlla.s[28]++;
        buf = finFormula.fixCasing(buf);

        //even when removing white lines, its takes more time to finsih buf = buf.replace(/\s*$/gm, '');//remove commented lines, and white lines before it
        //very exensive.. //buf = buf.replace(/[\r\n\s]+\s*[\r\n]*$/gm, '');//remove empty stuff
        //---TODO: Remove thing between here and row replacement, better to debug
        cov_29c2dnqlla.s[29]++;
        buf = buf.replace(/#(\w+)#/gim, "GetValue('$1')"); //these will be regular .value later

        //don't seem to loss anything if i just try these away
        cov_29c2dnqlla.s[30]++;
        buf = buf.replace(/\<\$/gim, '');
        cov_29c2dnqlla.s[31]++;
        buf = buf.replace(/\$\>/gim, '');

        //---------------- MOVE TO Formula
        //change (& to (
        //change ,&
        //i should do all these actions in mirror also
        //also this one, only for formulas
        //better try and move him
        cov_29c2dnqlla.s[32]++;
        buf = buf.replace(/(=|,|\()\s{0,4}\&/gm, ' $1 '); // replace all '=   &' and '(  &'   with = or ( respectively
        cov_29c2dnqlla.s[33]++;
        buf = buf.replace(/&\s{0,2}"/gm, '+"'); // & " => +"
        cov_29c2dnqlla.s[34]++;
        buf = buf.replace(/"\s{0,2}&/gm, '"+'); // " & => "+
        //---------------- END MOVE TO Formula

        //shortcut THIS WILL fail when parsing formulas containing strings..
        //remove  the '\', any ' and tabs
        cov_29c2dnqlla.s[35]++;
        buf = buf.replace(/['\\\t]/gm, ' ');
        //change the " to '
        cov_29c2dnqlla.s[36]++;
        buf = buf.replace(/["]/gm, '\'');
        //---TODO: Remove thing between here and row replacement, better to debug
        //variables first
        //still having appending title spaces.
        //PPP     1A   1 3               $>Warning voor X_MAP01_Vraag04<$                                    \X_MAP01_Vraag04
        //                       1                           2      3      4               4          5         6   7           8
        //                            2        3        4   11    12  15     16 24
        cov_29c2dnqlla.s[37]++;
        buf = buf.replace(/^([PIX]{1})[PIX ]{1}[PIX ]{2}.{7}(.).{3}(.).{4}(.).{3}\s*(.{12}.*?)\s*(\\|\=)?((?!:\w)(\w+))\s*(?:\nC(.*)|\n)/gmi, "{ \"_type\" : \"variables\" , " + "\"name\" : \"$7\" , " + "\"displaytype\" : \"$2\"," + "\"title\" : \"$5\"," + "\"_depth\" : $3," + "\"required\" : \"$4\"," + "\"hint\": \"$9\"," + "\"protection\" : \"$1\"," + "\"modifier\" : \"$6\" } ,\n");

        //Variable, single formulas
        //has prepending formula  spaces.
        cov_29c2dnqlla.s[38]++;
        buf = buf.replace(/\.Variable\s*(\w+)\s*,\s*(\w+).*?=(.*?)\s*$/gmi, "{ \"_type\": \"formulas\" , \"name\" : \"$1\" , \"formula\" : \"$3\" , \"property\" : \"$2\"  } , ");

        //formulas
        cov_29c2dnqlla.s[39]++;
        buf = buf.replace(/^(\w+)\s*=\s*(.*)\s*$/gmi, "{ \"_type\":\"formulas\" , \"name\" : \"$1\" , \"formula\": \"$2\" }, ");
        //state instructions
        cov_29c2dnqlla.s[40]++;
        buf = buf.replace(/^\.(\w+)\S*(\w*)?\S*(.*)$/gmi, "{ \"_type\" :\"state\" , \"name\" : \"$1\", \"meta\" : \"$2\"  } , ");

        //state instructions {{&&TryInclude and Language
        cov_29c2dnqlla.s[41]++;
        buf = buf.replace(/^\{&&(\w*)\s*=?"?'?([\w\-.]*)'?"?}\S*?/gmi, "{ \"_type\" :\"unknown\" , \"name\" : \"$1\", \"meta\" : \"'$2'\"  } , \n");

        //remove any lines that could not be parsed
        //includes Model-Title
        cov_29c2dnqlla.s[42]++;
        buf = buf.replace(/^((?!(?:[\{\s]))(.*))$/gmi, "{ \"_type\" : \"unknown\" , \"data\" : \"$2\" } , ");

        //remove last comma
        cov_29c2dnqlla.s[43]++;
        buf = buf.replace(/,(?=[^,]*$)/, "");

        var rows = (cov_29c2dnqlla.s[44]++, JSON.parse("[" + buf + "]"));
        cov_29c2dnqlla.s[45]++;
        buf = undefined; //this will speed up debug enormously
        //there are four types:
        //.Variable, just a variable formula, expect one formula, and one formula type;
        //.Formula a formula in a context
        //.Variables, a variable declarion
        //state: ModelName, Quit, level indent and rest.

        //we don't have to worry about spaces anymore
        //since .Variable, and .Formula are the same, but only interpret different we going to merge them

        //so we wanna go back to only two types, Formula an Variable declaration
        var solution = (cov_29c2dnqlla.s[46]++, {});
        var orderedByType = (cov_29c2dnqlla.s[47]++, {
            formulas: [],
            variables: []
        });

        var state = (cov_29c2dnqlla.s[48]++, {
            _type: 'init',
            name: 'name',
            meta: undefined
        });
        var nestedState = (cov_29c2dnqlla.s[49]++, {});
        cov_29c2dnqlla.s[50]++;
        for (var i = 0; i < rows.length; i++) {
            //clean up this too large if-then-else
            //ok so the format was designed to be interpreted line by line.
            //we going to add this information to every line when state changes.
            var obj = (cov_29c2dnqlla.s[51]++, rows[i]);

            cov_29c2dnqlla.s[52]++;
            if (obj._type === 'state') {
                cov_29c2dnqlla.b[4][0]++;
                cov_29c2dnqlla.s[53]++;

                if (obj.name === 'FesEvent') {
                    cov_29c2dnqlla.b[5][0]++;
                    cov_29c2dnqlla.s[54]++;

                    nestedState = obj;
                } else {
                    cov_29c2dnqlla.b[5][1]++;
                    cov_29c2dnqlla.s[55]++;

                    state = obj;
                }
            } else {
                    cov_29c2dnqlla.b[4][1]++;
                    cov_29c2dnqlla.s[56]++;
                    if (obj._type === 'unknown') {
                        cov_29c2dnqlla.b[6][0]++;

                        var objName = (cov_29c2dnqlla.s[57]++, obj.name === undefined ? (cov_29c2dnqlla.b[7][0]++, undefined) : (cov_29c2dnqlla.b[7][1]++, obj.name.toLowerCase()));
                        cov_29c2dnqlla.s[58]++;
                        if (types[objName]) {
                            cov_29c2dnqlla.b[8][0]++;
                            cov_29c2dnqlla.s[59]++;

                            types[objName](solution, obj);
                        } else {
                            cov_29c2dnqlla.b[8][1]++;
                            cov_29c2dnqlla.s[60]++;

                            types['unknown'](solution, obj);
                        }
                    } else {
                        cov_29c2dnqlla.b[6][1]++;
                        cov_29c2dnqlla.s[61]++;

                        //Trend,NotTrend, any addition to .Formula
                        obj._contextmeta = state.meta;
                        //ensure the array exists
                        //there are two groups, formulas and variables
                        cov_29c2dnqlla.s[62]++;
                        orderedByType[obj._type].push(obj);
                        //find a way to be case-insensitive
                        var objName = (cov_29c2dnqlla.s[63]++, ((cov_29c2dnqlla.b[9][0]++, obj.property) || (cov_29c2dnqlla.b[9][1]++, nestedState.name) || (cov_29c2dnqlla.b[9][2]++, state.name)).toLowerCase());

                        cov_29c2dnqlla.s[64]++;
                        if (types[objName] == undefined) {
                            cov_29c2dnqlla.b[10][0]++;
                            cov_29c2dnqlla.s[65]++;

                            log.warn('skipping type:[' + obj.property + " OR " + JSON.stringify(state) + "] its not yet registered.");
                            cov_29c2dnqlla.s[66]++;
                            continue;
                        } else {
                            cov_29c2dnqlla.b[10][1]++;
                        }
                        cov_29c2dnqlla.s[67]++;
                        types[objName](solution, obj);
                        cov_29c2dnqlla.s[68]++;
                        if (state.name === 'FesEvent') {
                            cov_29c2dnqlla.b[11][0]++;
                            cov_29c2dnqlla.s[69]++;

                            nestedState = {};
                        } else {
                            cov_29c2dnqlla.b[11][1]++;
                        }
                        cov_29c2dnqlla.s[70]++;
                        obj._type = undefined;
                    }
                }
        }

        cov_29c2dnqlla.s[71]++;
        if (solution.solutionName !== undefined) {
            cov_29c2dnqlla.b[12][0]++;
            cov_29c2dnqlla.s[72]++;

            solution.rows = rows;
            cov_29c2dnqlla.s[73]++;
            solution.orderedByType = orderedByType;
            cov_29c2dnqlla.s[74]++;
            solution.valid = true;
        } else {
            cov_29c2dnqlla.b[12][1]++;
        }
    } else {
        cov_29c2dnqlla.b[3][1]++;
    }
    //.info(types)
    cov_29c2dnqlla.s[75]++;
    return solution;
}
cov_29c2dnqlla.s[76]++;
module.exports = {
    parse: parseFinFile
};