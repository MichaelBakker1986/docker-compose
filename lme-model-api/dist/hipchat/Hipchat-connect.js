'use strict';

var cov_1c58l2irt7 = function () {
	var path = 'C:\\Users\\michael\\Documents\\lme\\lme-model-api\\hipchat\\Hipchat-connect.js',
	    hash = '14adaeabaeb8bc400e32bba9c1fcbf0da19cd4b6',
	    Function = function () {}.constructor,
	    global = new Function('return this')(),
	    gcv = '__coverage__',
	    coverageData = {
		path: 'C:\\Users\\michael\\Documents\\lme\\lme-model-api\\hipchat\\Hipchat-connect.js',
		statementMap: {
			'0': {
				start: {
					line: 4,
					column: 34
				},
				end: {
					line: 4,
					column: 50
				}
			},
			'1': {
				start: {
					line: 5,
					column: 13
				},
				end: {
					line: 5,
					column: 53
				}
			},
			'2': {
				start: {
					line: 6,
					column: 15
				},
				end: {
					line: 6,
					column: 33
				}
			},
			'3': {
				start: {
					line: 7,
					column: 24
				},
				end: {
					line: 7,
					column: 51
				}
			},
			'4': {
				start: {
					line: 8,
					column: 25
				},
				end: {
					line: 8,
					column: 113
				}
			},
			'5': {
				start: {
					line: 9,
					column: 19
				},
				end: {
					line: 9,
					column: 39
				}
			},
			'6': {
				start: {
					line: 13,
					column: 2
				},
				end: {
					line: 13,
					column: 142
				}
			},
			'7': {
				start: {
					line: 13,
					column: 24
				},
				end: {
					line: 13,
					column: 142
				}
			},
			'8': {
				start: {
					line: 14,
					column: 2
				},
				end: {
					line: 14,
					column: 154
				}
			},
			'9': {
				start: {
					line: 14,
					column: 34
				},
				end: {
					line: 14,
					column: 154
				}
			},
			'10': {
				start: {
					line: 18,
					column: 2
				},
				end: {
					line: 24,
					column: 3
				}
			},
			'11': {
				start: {
					line: 22,
					column: 4
				},
				end: {
					line: 22,
					column: 43
				}
			},
			'12': {
				start: {
					line: 22,
					column: 22
				},
				end: {
					line: 22,
					column: 43
				}
			},
			'13': {
				start: {
					line: 28,
					column: 2
				},
				end: {
					line: 30,
					column: 3
				}
			},
			'14': {
				start: {
					line: 29,
					column: 3
				},
				end: {
					line: 29,
					column: 42
				}
			},
			'15': {
				start: {
					line: 31,
					column: 2
				},
				end: {
					line: 31,
					column: 15
				}
			},
			'16': {
				start: {
					line: 35,
					column: 0
				},
				end: {
					line: 35,
					column: 37
				}
			}
		},
		fnMap: {
			'0': {
				name: '(anonymous_0)',
				decl: {
					start: {
						line: 12,
						column: 1
					},
					end: {
						line: 12,
						column: 2
					}
				},
				loc: {
					start: {
						line: 12,
						column: 15
					},
					end: {
						line: 15,
						column: 2
					}
				},
				line: 12
			},
			'1': {
				name: '(anonymous_1)',
				decl: {
					start: {
						line: 17,
						column: 1
					},
					end: {
						line: 17,
						column: 2
					}
				},
				loc: {
					start: {
						line: 17,
						column: 19
					},
					end: {
						line: 25,
						column: 2
					}
				},
				line: 17
			},
			'2': {
				name: '(anonymous_2)',
				decl: {
					start: {
						line: 21,
						column: 6
					},
					end: {
						line: 21,
						column: 7
					}
				},
				loc: {
					start: {
						line: 21,
						column: 15
					},
					end: {
						line: 23,
						column: 4
					}
				},
				line: 21
			},
			'3': {
				name: '(anonymous_3)',
				decl: {
					start: {
						line: 27,
						column: 1
					},
					end: {
						line: 27,
						column: 2
					}
				},
				loc: {
					start: {
						line: 27,
						column: 24
					},
					end: {
						line: 32,
						column: 2
					}
				},
				line: 27
			}
		},
		branchMap: {
			'0': {
				loc: {
					start: {
						line: 5,
						column: 13
					},
					end: {
						line: 5,
						column: 53
					}
				},
				type: 'binary-expr',
				locations: [{
					start: {
						line: 5,
						column: 13
					},
					end: {
						line: 5,
						column: 38
					}
				}, {
					start: {
						line: 5,
						column: 42
					},
					end: {
						line: 5,
						column: 53
					}
				}],
				line: 5
			},
			'1': {
				loc: {
					start: {
						line: 13,
						column: 2
					},
					end: {
						line: 13,
						column: 142
					}
				},
				type: 'if',
				locations: [{
					start: {
						line: 13,
						column: 2
					},
					end: {
						line: 13,
						column: 142
					}
				}, {
					start: {
						line: 13,
						column: 2
					},
					end: {
						line: 13,
						column: 142
					}
				}],
				line: 13
			},
			'2': {
				loc: {
					start: {
						line: 14,
						column: 2
					},
					end: {
						line: 14,
						column: 154
					}
				},
				type: 'if',
				locations: [{
					start: {
						line: 14,
						column: 2
					},
					end: {
						line: 14,
						column: 154
					}
				}, {
					start: {
						line: 14,
						column: 2
					},
					end: {
						line: 14,
						column: 154
					}
				}],
				line: 14
			},
			'3': {
				loc: {
					start: {
						line: 22,
						column: 4
					},
					end: {
						line: 22,
						column: 43
					}
				},
				type: 'if',
				locations: [{
					start: {
						line: 22,
						column: 4
					},
					end: {
						line: 22,
						column: 43
					}
				}, {
					start: {
						line: 22,
						column: 4
					},
					end: {
						line: 22,
						column: 43
					}
				}],
				line: 22
			},
			'4': {
				loc: {
					start: {
						line: 22,
						column: 8
					},
					end: {
						line: 22,
						column: 20
					}
				},
				type: 'binary-expr',
				locations: [{
					start: {
						line: 22,
						column: 8
					},
					end: {
						line: 22,
						column: 11
					}
				}, {
					start: {
						line: 22,
						column: 15
					},
					end: {
						line: 22,
						column: 20
					}
				}],
				line: 22
			},
			'5': {
				loc: {
					start: {
						line: 28,
						column: 2
					},
					end: {
						line: 30,
						column: 3
					}
				},
				type: 'if',
				locations: [{
					start: {
						line: 28,
						column: 2
					},
					end: {
						line: 30,
						column: 3
					}
				}, {
					start: {
						line: 28,
						column: 2
					},
					end: {
						line: 30,
						column: 3
					}
				}],
				line: 28
			},
			'6': {
				loc: {
					start: {
						line: 28,
						column: 6
					},
					end: {
						line: 28,
						column: 27
					}
				},
				type: 'binary-expr',
				locations: [{
					start: {
						line: 28,
						column: 6
					},
					end: {
						line: 28,
						column: 13
					}
				}, {
					start: {
						line: 28,
						column: 17
					},
					end: {
						line: 28,
						column: 27
					}
				}],
				line: 28
			},
			'7': {
				loc: {
					start: {
						line: 29,
						column: 22
					},
					end: {
						line: 29,
						column: 41
					}
				},
				type: 'binary-expr',
				locations: [{
					start: {
						line: 29,
						column: 22
					},
					end: {
						line: 29,
						column: 30
					}
				}, {
					start: {
						line: 29,
						column: 34
					},
					end: {
						line: 29,
						column: 41
					}
				}],
				line: 29
			}
		},
		s: {
			'0': 0,
			'1': 0,
			'2': 0,
			'3': 0,
			'4': 0,
			'5': 0,
			'6': 0,
			'7': 0,
			'8': 0,
			'9': 0,
			'10': 0,
			'11': 0,
			'12': 0,
			'13': 0,
			'14': 0,
			'15': 0,
			'16': 0
		},
		f: {
			'0': 0,
			'1': 0,
			'2': 0,
			'3': 0
		},
		b: {
			'0': [0, 0],
			'1': [0, 0],
			'2': [0, 0],
			'3': [0, 0],
			'4': [0, 0],
			'5': [0, 0],
			'6': [0, 0],
			'7': [0, 0]
		},
		_coverageSchema: '43e27e138ebf9cfc5966b082cf9a028302ed4184'
	},
	    coverage = global[gcv] || (global[gcv] = {});

	if (coverage[path] && coverage[path].hash === hash) {
		return coverage[path];
	}

	coverageData.hash = hash;
	return coverage[path] = coverageData;
}();

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _request = require('request');

var _request2 = _interopRequireDefault(_request);

var _log = require('log6');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var host_environment_variable = (cov_1c58l2irt7.s[0]++, process.env.HOST);
var host = (cov_1c58l2irt7.s[1]++, (cov_1c58l2irt7.b[0][0]++, host_environment_variable) || (cov_1c58l2irt7.b[0][1]++, '127.0.0.1'));
var domain = (cov_1c58l2irt7.s[2]++, process.env.DOMAIN);
var hipchat_api_key = (cov_1c58l2irt7.s[3]++, process.env.HIPCHAT_API_KEY);
var hipchat_endpoint = (cov_1c58l2irt7.s[4]++, 'https://topicus.hipchat.com/v2/room/4235024/notification?auth_token=' + hipchat_api_key);
var developer = (cov_1c58l2irt7.s[5]++, host === 'localhost');

var HipchatConnect = function () {
	function HipchatConnect() {
		(0, _classCallCheck3.default)(this, HipchatConnect);
		cov_1c58l2irt7.f[0]++;
		cov_1c58l2irt7.s[6]++;

		if (!hipchat_api_key) {
				cov_1c58l2irt7.b[1][0]++;
				cov_1c58l2irt7.s[7]++;
				(0, _log.warn)('No communication with the HipChat server is possible, because environment variable HIPCHAT_API_KEY is not set.');
			} else {
			cov_1c58l2irt7.b[1][1]++;
		}cov_1c58l2irt7.s[8]++;
		if (!host_environment_variable) {
				cov_1c58l2irt7.b[2][0]++;
				cov_1c58l2irt7.s[9]++;
				(0, _log.info)('Not communicating with the HipChat server, because environment variable HOST is not set. Assume developer build.');
			} else {
			cov_1c58l2irt7.b[2][1]++;
		}
	}

	(0, _createClass3.default)(HipchatConnect, [{
		key: 'send',
		value: function send(text, level) {
			cov_1c58l2irt7.f[1]++;
			cov_1c58l2irt7.s[10]++;

			_request2.default.post({
				url: hipchat_endpoint,
				json: { 'color': level, 'message': '[' + domain + '] ' + text }
			}, function (err) {
				cov_1c58l2irt7.f[2]++;
				cov_1c58l2irt7.s[11]++;

				if ((cov_1c58l2irt7.b[4][0]++, err) && (cov_1c58l2irt7.b[4][1]++, _log.DEBUG)) {
						cov_1c58l2irt7.b[3][0]++;
						cov_1c58l2irt7.s[12]++;
						(0, _log.debug)(err.toString());
					} else {
					cov_1c58l2irt7.b[3][1]++;
				}
			});
		}
	}, {
		key: 'log',
		value: function log(message, levelArg) {
			cov_1c58l2irt7.f[3]++;
			cov_1c58l2irt7.s[13]++;

			if ((cov_1c58l2irt7.b[6][0]++, message) && (cov_1c58l2irt7.b[6][1]++, !developer)) {
				cov_1c58l2irt7.b[5][0]++;
				cov_1c58l2irt7.s[14]++;

				this.send(message, (cov_1c58l2irt7.b[7][0]++, levelArg) || (cov_1c58l2irt7.b[7][1]++, 'green'));
			} else {
				cov_1c58l2irt7.b[5][1]++;
			}
			cov_1c58l2irt7.s[15]++;
			(0, _log.info)(message);
		}
	}]);
	return HipchatConnect;
}();

cov_1c58l2irt7.s[16]++;


module.exports = new HipchatConnect();