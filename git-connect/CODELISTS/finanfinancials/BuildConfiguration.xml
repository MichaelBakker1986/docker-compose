<?xml version="1.0" encoding="UTF-8"?>
<project default="make-zipfile-default" name="Make_ZipFile">
  <tstamp>
    <format property="ldt" pattern="yyyy-MM-dd_HHmm" locale="en,UK"/>
  </tstamp>

  <target name="make-zipfile-default" description="Make the ZipFile">
  	<copy todir="${todir}" flatten="true" enablemultiplemappings="true" overwrite="false">
		  <fileset file="${basedir}/../Finan/V05/Reports/*"/>
      <fileset file="${basedir}/../Finan/V05_FinanOnline/_Project/emails.*"/>
      <fileset file="${basedir}/../Finan/V05/Screendefinitions/screendefinition.*"/>
      <fileset file="${basedir}/../Finan/V05/FMT/Master/filters.*"/>
      <fileset file="${basedir}/../Finan/V05/FMT/Tables/mappings.*.mapping"/>
      <mappedresources>
        <fileset file="${basedir}/../Finan/V05_FinanOnline/_Project/translations.*"/>
        <globmapper from="translations.ff_prognose_translations.csv" to="translations.ff_prognose_translations.translation"/>
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/../Finan/V05_FinanOnline/_Project/translations.*" />
        <globmapper from="translations.V05.csv" to="translations.V05.translation" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/../Finan/V05_FinanOnline/_Project/translations.*" />
        <globmapper from="translations.finanfinancials.csv" to="translations.finanfinancials.translation" />
      </mappedresources>      
      <mappedresources>
        <fileset file="${basedir}/../Finan/V05/Matrices/MonitoringApp.xls"/>
        <globmapper from="MonitoringApp.xls" to="matrices.MonitoringApp.xls.matrix"/>
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/../Finan/V05/Matrices/TaxRates.xls"/>
        <globmapper from="TaxRates.xls" to="matrices.TaxRates.xls.matrix"/>
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/../Finan/V05/Matrices/V05_ForecastSettings.xls"/>
        <globmapper from="V05_ForecastSettings.xls" to="matrices.V05_ForecastSettings.xls.matrix"/>
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/../Finan/V05/FMT/Master/*.Fmt4Model.xml"/>
        <globmapper from="V05.Fmt4Model.xml" to="targets.V05.targets"/>
      </mappedresources>
      <mappedresources>
				<fileset file="${basedir}/../Finan/V05/FMT/Tables/*.xml" />
				<globmapper from="*.Fmt4Table.xml" to="mappings.*.mapping" />
			</mappedresources>
			<mappedresources>
				<fileset file="${basedir}/../Finan/FAM/Translations/*.csv" />
				<globmapper from="translations.model_FAM.csv" to="translations.model_FAM.translation" />
			</mappedresources>
			<mappedresources>
				<fileset file="${basedir}/../Finan/FAM/Reports/*.xml" />
				<globmapper from="questionnaire-fam.frb.xml" to="reports.questionnaire-fam.frb-xml" />
			</mappedresources>
			<mappedresources>
				<fileset file="${basedir}/../Finan/FAM/Reports/*.rpt" />
				<globmapper from="questionnaire-fam.frb.rpt" to="reports.questionnaire-fam.frb-rpt" />
			</mappedresources>
			<mappedresources>
				<fileset file="${basedir}/../Finan/KAM/Reports/*.frb-xml" />
			</mappedresources>
			<mappedresources>
				<fileset file="${basedir}/../Finan/FAM/Matrices/*" />
				<globmapper from="PRODUCTSELECTION.xls" to="matrices.PRODUCTSELECTION.xls.matrix" />
			</mappedresources>
			<mappedresources>
				<fileset file="${basedir}/../Finan/FAM/FMT/Tables/*.xml" />
				<globmapper from="*.Fmt4Table.xml" to="mappings.*.mapping" />
			</mappedresources>
			<mappedresources>
				<fileset file="${basedir}/../Finan/KAM/FMT/Tables/*.xml" />
				<globmapper from="*.Fmt4Table.xml" to="mappings.*.mapping" />
			</mappedresources>
			<mappedresources>
				<fileset file="${basedir}/../Finan/KAM/Matrices/KAM_Parameters.xls" />
				<globmapper from="KAM_Parameters.xls" to="matrices.KAM_Parameters.xls.matrix" />
			</mappedresources>
			<mappedresources>
				<fileset file="${basedir}/../Finan/Rating/FFL/RATING.ffl" />
				<globmapper from="*" to="ffl.*" />
			</mappedresources>
			<mappedresources>
				<fileset file="${basedir}/../Finan/Rating/FMT/Tables/*.xml" />
				<globmapper from="*.Fmt4Table.xml" to="mappings.*.mapping" />
			</mappedresources>
			<mappedresources>
				<fileset file="${basedir}/../Finan/Rating/Reports/*.xml" />
				<globmapper from="*.frb.xml" to="reports.*.frb-xml" />
			</mappedresources>
			<mappedresources>
				<fileset file="${basedir}/../Finan/Rating/Reports/*.rpt" />
				<globmapper from="*.frb.rpt" to="reports.*.frb-rpt" />
			</mappedresources>
			<mappedresources>
				<fileset file="${basedir}/../Finan/V05_FinanOnline/FFL/V05.FFL" />
				<globmapper from="*" to="ffl.*" />
			</mappedresources>
		</copy>
	</target>

	<target name="make-zipfile-finan" description="Make the ZipFile">
		<copy todir="${basedir}/../Finan/_ZipFile/configuration_finan_${ldt}" flatten="true" enablemultiplemappings="true">
		  <fileset file="${basedir}/../Finan/KAM/Reports/finan/reports.questionnaire-kam_sra.frb-rpt" />
			<mappedresources>
				<fileset file="${basedir}/../Finan/V05_FinanOnline/Reports/finan/reports.reports.frb-rpt" />
				<globmapper from="reports.reports.frb-rpt" to="reports.questionnaire-kam.frb-rpt" />
			</mappedresources>
			<fileset file="${basedir}/../Finan/V05_FinanOnline/Reports/finan/*" />
			<fileset file="${basedir}/../Finan/V05_FinanOnline/Screendefinitions/*.screendefinition" />
			<fileset file="${basedir}/../Finan/V05_FinanOnline/_Project/finan/*.*" />
		</copy>
		<antcall target="make-zipfile-default">
			<param name="todir" value="${basedir}/../Finan/_ZipFile/configuration_finan_${ldt}" />
		</antcall>
		<zip destfile="${basedir}/../Finan/_ZipFile/configuration_finan_${ldt}.zip">
			<fileset file="${basedir}/../Finan/_ZipFile/configuration_finan_${ldt}/*.*" />
		</zip>
		<delete dir="${basedir}/../Finan/_ZipFile/configuration_finan_${ldt}"/>
	</target>

  <target name="make-zipfile-test" description="Make the ZipFile">
    <zip destfile="${basedir}/../Finan/_ZipFile/configuration_test_${ldt}.zip" filesonly="true">
      <mappedresources>
        <fileset file="${basedir}/../Finan/../TEST/ScorecardTestModel/FFL/*.ffl"/>
        <globmapper from="*" to="ffl.*"/>
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/../Finan/../TEST/ScorecardTestModel/Reports/*.xml"/>
        <globmapper from="questionnaire-ScorecardTestModel.frb.xml" to="reports.questionnaire-SCORECARDTESTMODEL.frb-xml"/>
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/../Finan/../TEST/ScorecardTestModel/Reports/*.rpt"/>
        <globmapper from="questionnaire-ScorecardTestModel.frb.rpt" to="reports.questionnaire-SCORECARDTESTMODEL.frb-rpt"/>
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/../Finan/../TEST/ScorecardTestModel/Matrices/ScorecardTestModel.xls"/>
        <globmapper from="ScorecardTestModel.xls" to="matrices.ScorecardTestModel.xls.matrix"/>
      </mappedresources>
    </zip>
  </target>

  <target name="make-zipfile-bob" description="Make the ZipFile">
    <zip destfile="${basedir}/../Finan/_ZipFile/configuration_bob_${ldt}.zip" filesonly="true">
      <fileset file="${basedir}/../Finan/_ZipFile/configuration_finan_*.zip"/>
      <fileset file="${basedir}/../Finan/_ZipFile/configuration_test_*.zip"/>
    </zip>
  </target>
</project>
