<?xml version="1.0" encoding="UTF-8"?>
<project default="make-zipfile-aab-all" name="Make_ZipFile">
  <tstamp>
    <format property="ldt" pattern="yyyy-MM-dd_HHmm" locale="en,UK" />
  </tstamp>

  <target name="pr-aab-all" description="Make the ZipFile">
    <antcall target="make-zipfile-mappings" />
    <antcall target="make-zipfile-translations" />
    <antcall target="make-zipfile-matrices" />
    <antcall target="make-zipfile-screendefinitions" />
    <antcall target="make-zipfile-reports" />
    <antcall target="make-zipfile-ffl-all" />
  </target>

  <target name="make-zipfile-aab-test" description="Make the ZipFile">
    <mkdir dir="${basedir}/_ZipFile" />
    <delete>
      <fileset dir="${basedir}/_ZipFile/" includes="**/*.zip" />
    </delete>
    <antcall target="make-zipfile-mappings" />
    <antcall target="make-zipfile-translations" />
    <antcall target="make-zipfile-matrices" />
    <antcall target="make-zipfile-screendefinitions" />
    <antcall target="make-zipfile-reports" />
    <antcall target="make-zipfile-ffl-all" />
    <antcall target="make-zipfile-emails" />

    <zip destfile="${basedir}/_ZipFile/configurations_aab_test_${ldt}.zip">
      <fileset dir="${basedir}/_ZipFile" includes="*.zip" excludes="configurations_aab_*.zip" />
    </zip>
  </target>

  <target name="make-zipfile-aab-all" description="Make the ZipFile">
    <mkdir dir="${basedir}/_ZipFile" />
    <delete>
      <fileset dir="${basedir}/_ZipFile/" includes="**/*.zip" />
    </delete>
    <antcall target="make-zipfile-mappings" />
    <antcall target="make-zipfile-translations" />
    <antcall target="make-zipfile-matrices" />
    <antcall target="make-zipfile-screendefinitions" />
    <antcall target="make-zipfile-reports" />
    <antcall target="make-zipfile-models" />
    <antcall target="make-zipfile-ffl" />
    <antcall target="make-zipfile-emails" />

    <zip destfile="${basedir}/_ZipFile/configuration_aab_all_${ldt}.zip">
      <fileset dir="${basedir}/_ZipFile/" includes="*.zip" excludes="configurations_aab_*.zip" />
    </zip>
  </target>

  <target name="make-zipfile-mappings" description="Make the ZipFile">
    <zip destfile="${basedir}/_ZipFile/configuration_aab_mappings_${ldt}.zip" filesonly="true" update="yes" duplicate="preserve">
      <mappedresources>
        <fileset file="${basedir}/../Finan/V05/FMT/Tables/*.xml" />
        <globmapper from="*.Fmt4Table.xml" to="mappings.*.mapping" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/AABPRICING/FMT/Tables/*.xml" />
        <globmapper from="*.Fmt4Table.xml" to="mappings.*.mapping" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/FINANCINGTARGETSC/FMT/Tables/*.xml" />
        <globmapper from="*.Fmt4Table.xml" to="mappings.*.mapping" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/BTAGROSC/FMT/Tables/*.xml" />
        <globmapper from="*.Fmt4Table.xml" to="mappings.*.mapping" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/V05/FMT/Tables/*.xml" />
        <globmapper from="*.Fmt4Table.xml" to="mappings.*.mapping" />
      </mappedresources>
    </zip>
  </target>

  <target name="make-zipfile-ffl" description="Make the ZipFile">
    <zip destfile="${basedir}/_ZipFile/configuration_aab_ffl_${ldt}.zip" filesonly="true" update="yes" duplicate="preserve">
      <mappedresources>
        <fileset file="${basedir}/VBI/FFL/VBI.ffl" />
        <globmapper from="VBI.ffl" to="ffl.VBI.ffl" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/FINANCINGTARGETSC/FFL/FINANCINGTARGETSC.ffl" />
        <globmapper from="FINANCINGTARGETSC.ffl" to="ffl.FINANCINGTARGETSC.ffl" />
      </mappedresources>
    </zip>
  </target>

  <target name="make-zipfile-translations" description="Make the ZipFile">
    <zip destfile="${basedir}/_ZipFile/configuration_aab_translations_${ldt}.zip" filesonly="true" update="yes" duplicate="preserve">
      <mappedresources>
        <fileset file="${basedir}/../Finan/V05_FinanOnline/_Project/translations.*" />
        <globmapper from="translations.ff_prognose_translations.csv" to="translations.generic_translation.translation" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/../Finan/V05_FinanOnline/_Project/translations.*" />
        <globmapper from="translations.V05.csv" to="translations.V05.translation" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/../Finan/V05_FinanOnline/_Project/translations.*" />
        <globmapper from="translations.finanfinancials.csv" to="translations.finanfinancials.translation" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/_Project/translations.zz_aab_translations.csv" />
        <globmapper from="translations.zz_aab_translations.csv" to="translations.zz_aab.translation" />
      </mappedresources>
    </zip>
  </target>

  <target name="make-zipfile-matrices" description="Make the ZipFile">
    <zip destfile="${basedir}/_ZipFile/configuration_aab_matrices_${ldt}.zip" filesonly="true" update="yes" duplicate="preserve">
      <mappedresources>
        <fileset file="${basedir}/VBI/Matrices/matrices.VBI.xls" />
        <globmapper from="matrices.VBI.xls" to="matrices.VBI.xls.matrix" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/NONFINANCIALANALYSIS/Matrices/matrices.NonFinancialAnalysis.xls" />
        <globmapper from="matrices.NonFinancialAnalysis.xls" to="matrices.NonFinancialAnalysis.xls.matrix" />
      </mappedresources>
      <mappedresources>
        <zipfileset file="${basedir}/../Finan/V05/Matrices/matrices.MonitoringApp.xls" />
        <globmapper from="matrices.MonitoringApp.xls" to="matrices.MonitoringApp.xls.matrix" />
      </mappedresources>
      <mappedresources>
        <zipfileset file="${basedir}/AABPRICING/Matrices/SBISECTORENAGIC.xls" />
        <globmapper from="SBISECTORENAGIC.xls" to="matrices.SBISECTORENAGIC.xls.matrix" />
      </mappedresources>
      <mappedresources>
        <zipfileset file="${basedir}/AABPRICING/Matrices/AAB_Parameters.xls" />
        <globmapper from="AAB_Parameters.xls" to="matrices.AAB_Parameters.xls.matrix" />
      </mappedresources>
      <mappedresources>
        <zipfileset file="${basedir}/AABPRICING/Matrices/AAB_Parameters_ELMultiplier.xls" />
        <globmapper from="AAB_Parameters_ELMultiplier.xls" to="matrices.AAB_Parameters_ELMultiplier.xls.matrix" />
      </mappedresources>
      <mappedresources>
        <zipfileset file="${basedir}/V05/Matrices/BBIScore.xls" />
        <globmapper from="BBIScore.xls" to="matrices.BBIScore.xls.matrix" />
      </mappedresources>
      <mappedresources>
        <zipfileset file="${basedir}/V05/Matrices/TaxRates.xls" />
        <globmapper from="TaxRates.xls" to="matrices.TaxRates.xls.matrix" />
      </mappedresources>
      <mappedresources>
        <zipfileset file="${basedir}/V05/Matrices/V05_ForecastSettings.xls" />
        <globmapper from="V05_ForecastSettings.xls" to="matrices.V05_ForecastSettings.xls.matrix" />
      </mappedresources>
      <mappedresources>
        <zipfileset file="${basedir}/_Project/matrices.LegalForm.xls.matrix" />
        <globmapper from="matrices.LegalForm.xls.matrix" to="matrices.LegalForm.xls.matrix" />
      </mappedresources>
    </zip>
  </target>

  <target name="make-zipfile-screendefinitions" description="Make the ZipFile">
    <zip destfile="${basedir}/_ZipFile/configuration_aab_screendefinitions_${ldt}.zip" filesonly="true" update="yes" duplicate="preserve">
      <fileset file="${basedir}/V05/Screendefinitions/screendefinition.*.screendefinition" />
      <fileset file="${basedir}/../Finan/V05_FinanOnline/Screendefinitions/screendefinition.sli_start_panel_json_url.screendefinition" />
      <fileset file="${basedir}/../Finan/V05/Screendefinitions/screendefinition.*.screendefinition">
        <exclude name="screendefinition.budget_edit_json_url.screendefinition" />
        <exclude name="screendefinition.dashboard_json.screendefinition" />
        <exclude name="screendefinition.history_edit_json_file_url.screendefinition" />
        <exclude name="screendefinition.prognose_start_panel_json_url.screendefinition" />
        <exclude name="screendefinition.prognose_option_categories_json.screendefinition" />
      </fileset>
    </zip>
  </target>

  <target name="make-zipfile-reports" description="Make the ZipFile">
    <zip destfile="${basedir}/_ZipFile/configuration_aab_reports_${ldt}.zip" filesonly="true" update="yes" duplicate="preserve">
      <fileset file="${basedir}/AABPRICING/Reports/reports.*.*" />
      <fileset file="${basedir}/V05/Reports/reports.*.frb-xml" />
      <mappedresources>
        <fileset file="${basedir}/V05/Reports/reports.*.frb-rpt" />
        <globmapper from="reports.*.frb-rpt" to="reports.reports.frb-rpt" />
      </mappedresources>
      <fileset file="${basedir}/../Finan/V05/Reports/*.frb-xml">
        <exclude name="reports.financialfactsheet.frb-xml" />
      </fileset>
      <fileset file="${basedir}/../Finan/V05_FinanOnline/_Project/reports.definitions.config" />
    </zip>
  </target>

  <target name="make-zipfile-emails" description="Make the ZipFile">
    <zip destfile="${basedir}/_ZipFile/configuration_aab_emails_${ldt}.zip" filesonly="true" update="yes" duplicate="preserve">
      <fileset file="${basedir}/../Finan/V05_FinanOnline/_Project/emails.*.text" />
    </zip>
  </target>

  <target name="make-zipfile-models" description="Make the ZipFile">
    <zip destfile="${basedir}/_ZipFile/configuration_aab_models_${ldt}.zip" duplicate="preserve">
      <fileset file="${basedir}/AABPRICING/JAR/models.AABPRICING.model" />
      <fileset file="${basedir}/BTAGROSC/JAR/models.BTAGROSC.model" />
      <fileset file="${basedir}/NONFINANCIALANALYSIS/JAR/models.NONFINANCIALANALYSIS.model" />
      <fileset file="${basedir}/STEP5SC/JAR/models.STEP5SC.model" />
      <fileset file="${basedir}/V05/JAR/models.V05.model" />
      <mappedresources>
        <fileset file="${basedir}/VBI/FFL/VBI.ffl" />
        <globmapper from="VBI.ffl" to="ffl.VBI.ffl" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/FINANCINGTARGETSC/FFL/FINANCINGTARGETSC.ffl" />
        <globmapper from="FINANCINGTARGETSC.ffl" to="ffl.FINANCINGTARGETSC.ffl" />
      </mappedresources>
    </zip>
  </target>

  <target name="make-zipfile-ffl-all" description="Make the ZipFile">
    <zip destfile="${basedir}/_ZipFile/configuration_aab_ffl_models_${ldt}.zip" duplicate="preserve">
      <mappedresources>
        <fileset file="${basedir}/AABPRICING/FFL/AABPRICING.ffl" />
        <globmapper from="AABPRICING.ffl" to="ffl.AABPRICING.ffl" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/NONFINANCIALANALYSIS/FFL/NONFINANCIALANALYSIS.ffl" />
        <globmapper from="NONFINANCIALANALYSIS.ffl" to="ffl.NONFINANCIALANALYSIS.ffl" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/STEP5SC/FFL/STEP5SC.ffl" />
        <globmapper from="STEP5SC.ffl" to="ffl.STEP5SC.ffl" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/V05/FFL/V05.ffl" />
        <globmapper from="V05.ffl" to="ffl.V05.ffl" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/VBI/FFL/VBI.ffl" />
        <globmapper from="VBI.ffl" to="ffl.VBI.ffl" />
      </mappedresources>
      <mappedresources>
        <fileset file="${basedir}/FINANCINGTARGETSC/FFL/FINANCINGTARGETSC.ffl" />
        <globmapper from="FINANCINGTARGETSC.ffl" to="ffl.FINANCINGTARGETSC.ffl" />
      </mappedresources>
    </zip>
  </target>
</project>
