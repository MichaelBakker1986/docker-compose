// model "Loan Pricing Tool"
// created by FINAN 3.2.57.15

import FinanMath.*;
import BaseModel.*;

model TDSCPRICING uses BaseModel
{
  version: "2.0.1.8";
  ffl_version: "1.2";
  root
  {
    variable RootSub1
    {
      datatype: none;
      frequency: none;
      title: "General variables for webclient";
      top_blanklines: 1;
      display_options: showColumnTitlesAboveSubVars;
      locked: 1;
      options_title: locked, invisible;
      options: locked, invisible;
      variable FES_LAYOUTNR
      {
        datatype: number;
        frequency: document;
        formula: If(Pos("IFRS-EU",&FES_LAYOUT[1])>0,1,If(Pos("IFRS-PL",&FES_LAYOUT[1])>0,48,If(Pos("IFRS-Intl",&FES_LAYOUT[1])>0,2,0)));
        data_options: unscalable;
        displaytype: select;
        title: "Layout";
        top_blanklines: 1;
        locked: 1;
        visible: 1;
        choices: "0: NA|1: IFRS-EU|2: IFRS|48: Polish";
        options_title: locked;
        options: locked;
      }
      variable FES_EXCHANGE_RATES
      {
        datatype: string;
        frequency: column;
        aggregation: balance;
        data_options: unscalable;
        title: "Exchange Rates";
        top_separator: 1;
        bottom_separator: 1;
        visible: 1;
        options_title: locked;
      }
      variable FES_LAYOUT
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "Layout name";
        visible: 1;
        options_title: locked;
      }
      variable FES_FLATINPUT
      {
        datatype: number;
        frequency: document;
        data_options: unscalable;
        fixed_decimals: 0;
        title: "Is flat input used? (1=yes)";
        visible: 1;
        options_title: locked;
      }
      variable FES_PROJECTION_PROFILE
      {
        datatype: number;
        frequency: document;
        data_options: unscalable;
        fixed_decimals: 0;
        title: "Projection Profile";
        visible: 1;
        options_title: locked;
      }
      variable FES_COLUMN_ORDER
      {
        datatype: number;
        frequency: document;
        data_options: unscalable;
        fixed_decimals: 0;
        title: "Column order";
        visible: 1;
        options_title: locked;
      }
      variable FES_COLUMN_VISIBLE
      {
        datatype: number;
        frequency: column;
        aggregation: balance;
        formula_notrend: 1;
        formula_trend: 1;
        data_options: unscalable;
        fixed_decimals: 0;
        title: "Column visible";
        top_separator: 1;
        visible: 1;
        options_title: locked;
      }
      variable FES_STARTDATEPERIOD
      {
        datatype: number;
        frequency: column;
        aggregation: balance;
        data_options: unscalable;
        fixed_decimals: 0;
        title: "Start Date Period";
        visible: 1;
        options_title: locked;
      }
      variable FES_ENDDATEPERIOD
      {
        datatype: number;
        frequency: column;
        aggregation: balance;
        data_options: unscalable;
        fixed_decimals: 0;
        title: "End Date Period";
        visible: 1;
        options_title: locked;
      }
      variable FES_BASECURRENCYPERIOD
      {
        datatype: number;
        frequency: column;
        aggregation: balance;
        data_options: unscalable;
        fixed_decimals: 0;
        title: "Base Currency Period";
        visible: 1;
        options_title: locked;
      }
      variable FES_VIEWCURRENCYPERIOD
      {
        datatype: number;
        frequency: column;
        aggregation: balance;
        data_options: unscalable;
        fixed_decimals: 0;
        title: "View Currency Period";
        visible: 1;
        options_title: locked;
      }
      variable FES_COLUMNTYPE
      {
        datatype: number;
        frequency: column;
        aggregation: balance;
        data_options: unscalable;
        displaytype: select;
        fixed_decimals: 0;
        title: "Column Type";
        visible: 1;
        choices: "0:History|1:Projection";
        options_title: locked;
      }
    }
    variable RootSub2
    {
      datatype: none;
      frequency: none;
      title: "General variables for FPS database";
      locked: 1;
      options_title: locked, invisible;
      options: locked, invisible;
      variable FPS_VAR_Naam
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "NAME";
        top_blanklines: 1;
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_Relatienummer
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "CUSTOMERNUMBER";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_KVKnr
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "CHAMBEROFCOMMERCENUMBER";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_Rechtsvorm_nr
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "LEGALSTATUSCODE";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_Rechtsvorm_omschr
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "LEGALSTATUSDESCRIPTION";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_BIK_CODE
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "SECTOROFINDUSTRYCODE";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_BIK_Omschr
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "SECTOROFINDUSTRYDESCRIPTION";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_GridId
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "GRIDID";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_Accountmanager
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "ACCOUNTMANAGER";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_Kantoor
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "OFFICENUMBER";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_Straat
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "STREET";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_Housenumber
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "HOUSENUMBER";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_Postcode
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "ZIPCODE";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_Woonplaats
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "CITY";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_Provincie
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "STATEORPROVINCE";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_Land
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "COUNTRY";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_BvDID
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "Bureau van Dijk ID";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_Telefoon
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "Telefoonnummer";
        visible: 1;
        options_title: locked;
      }
      variable FPS_VAR_Emailadres
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "Emailadres";
        visible: 1;
        options_title: locked;
      }
      variable FPS_FINAN_USER_ROLES
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "FPS_FINAN_USER_ROLES";
        visible: 1;
        options_title: locked;
      }
      variable FPS_FINAN_USER
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "FPS_FINAN_USER";
        visible: 1;
        options_title: locked;
      }
    }
    variable Q_ROOT
    {
      datatype: number;
      frequency: document;
      formula: If(((Q_MAP01[1]=1) and (Q_MAP02[1]=1) and (Q_MAP07[1]=1)) or (Length(&scKnockoutsCombi[1])>0),1,0);
      data_options: unscalable;
      displaytype: select;
      title: "Loan Pricing Tool";
      top_blanklines: 1;
      locked: 1;
      visible: 1;
      choices: "0:Complete.|1:Not complete.";
      options_title: locked;
      options: locked;
      variable Q_MAP01
      {
        datatype: number;
        frequency: document;
        formula: (Q_MAP01_ENTEREDREQUIREDVARS=Q_MAP01_REQUIREDVARS);
        data_options: unscalable;
        displaytype: select;
        title: "Rating";
        top_blanklines: 1;
        locked: 1;
        visible: 1;
        choices: "0:Complete.|1:Not complete.";
        options_title: locked;
        options: locked;
        variable Q_MAP01_WARNING
        {
          datatype: string;
          frequency: document;
          formula: EvaluateAsString(Q_WARNING_GLOBAL[1]);
          data_options: unscalable;
          title: "Warning voor map";
          top_blanklines: 1;
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
        variable Q_MAP01_INFO
        {
          datatype: string;
          frequency: document;
          formula: EvaluateAsString(If(Q_MAP01[1]=0,&"not all required questions in this step are completed. [BR][/BR]Mandatory questions are marked with a *.",&""));
          data_options: unscalable;
          title: "Info bij stap";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
        variable Q_MAP01_VALIDATION
        {
          datatype: string;
          frequency: document;
          formula: EvaluateAsString(Q_GLOBAL_VALIDATION);
          data_options: unscalable;
          title: "Validatie stap";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
        variable Q_MAP01A_ALGEMEEN
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Main Borrower Details";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
          variable Q_MAP01A_ALGEMEENSUB1 refers to Q_MODELVERSION
          {
            datatype: string;
            frequency: document;
            data_options: unscalable;
            title: "Modelversion:";
            top_blanklines: 1;
            locked: 1;
            visible: 1;
            options_title: locked;
            options: locked;
          }
          variable Q_MAP01A_ALGEMEENSUB2 refers to Q_MATRIXVERSION
          {
            datatype: string;
            frequency: document;
            data_options: unscalable;
            title: "Parameters version:";
            locked: 1;
            visible: 1;
            options_title: locked;
            options: locked;
          }
        }
        variable BranchParagraph
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Branch selection";
          locked: 1;
          visible: (ShowHiddenFields);
          options_title: locked;
          options: locked;
          variable Branchselection
          {
            datatype: number;
            frequency: document;
            formula: If((&whitelabel="Triodos BE"),0,If((&whitelabel="Triodos NL"),1,If((&whitelabel="Triodos UK") or (&whitelabel="Triodos EN"),2,NA)));
            data_options: unscalable;
            displaytype: select;
            title: "Please select the branch";
            top_blanklines: 1;
            visible: 1;
            choices: "0:Belgium|1:The Netherlands|2:United Kingdom";
            options_title: locked;
          }
          variable whitelabel
          {
            datatype: string;
            frequency: document;
            data_options: unscalable;
            title: "Whitelabel (From force)";
            visible: 1;
            options_title: locked;
          }
        }
        variable Q_MAP01_PARAGRAAF1
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Rating (Calculated)";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
          variable Q_MAP01_PARAGRAAF1SUB1 refers to IMPORT_Rating
          {
            datatype: number;
            frequency: document;
            inputRequired: 1;
            data_options: unscalable;
            displaytype: select;
            title: "Rating";
            top_blanklines: 1;
            locked: 1;
            visible: 1;
            choices: "14:14|13:13|12:12|11:11|10:10|9:9|8:8|7:7|6:6|5:5|4:4|3:3|2:2|1:1";
            options_title: locked;
            options: locked;
          }
          variable Q_MAP01_PARAGRAAF1SUB2 refers to IMPORT_PD
          {
            datatype: number;
            frequency: document;
            inputRequired: 1;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 4;
            title: "Probability of Default";
            locked: 1;
            visible: 1;
            options_title: locked;
            options: locked;
          }
        }
        variable Q_MAP01_PARAGRAAF2
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Rating (Used)";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
          variable Rating
          {
            datatype: number;
            frequency: document;
            formula: IMPORT_Rating;
            data_options: unscalable;
            displaytype: select;
            title: "Rating";
            top_blanklines: 1;
            visible: 1;
            choices: "14:14|13:13|12:12|11:11|10:10|9:9|8:8|7:7|6:6|5:5|4:4|3:3|2:2|1:1";
            options_title: locked;
          }
          variable PD
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(PD_FIXED), PD_FIXED, MatrixLookup("TRIODOS_Parameters.xls","Rating2PD",Rating,1));
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 4;
            title: "Probability of Default";
            locked: 1;
            visible: 1;
            options_title: locked;
            options: locked;
          }
          variable RatingMemo
          {
            datatype: string;
            frequency: document;
            inputRequired: (DataEntered(Rating,1));
            data_options: unscalable;
            displaytype: memo;
            title: "Explanation";
            visible: (DataEntered(Rating,1));
            options_title: locked;
          }
        }
        variable Q_MAP01_HULPVARIABELEN
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Hulpvariabelen";
          locked: 1;
          visible: 0;
          options_title: locked;
          options: locked;
          variable Q_MAP01_REQUIREDVARS
          {
            datatype: number;
            frequency: document;
            formula: Count(X,SelectDescendants(Q_MAP01, Q_MAP01_HULPVARIABELEN),InputRequired(X));
            displaytype: currency;
            title: "Aantal verplichte velden (1)";
            top_blanklines: 1;
            locked: 1;
            visible: 0;
            options_title: locked;
            options: locked;
          }
          variable Q_MAP01_ENTEREDREQUIREDVARS
          {
            datatype: number;
            frequency: document;
            formula: Count(X,SelectDescendants(Q_MAP01, Q_MAP01_HULPVARIABELEN),InputRequired(X) and DataAvailable(X));
            displaytype: currency;
            title: "Aantal ingevulde verplichte velden (1)";
            locked: 1;
            visible: 0;
            options_title: locked;
            options: locked;
          }
          variable AgreementNumber
          {
            datatype: string;
            frequency: document;
            data_options: unscalable;
            title: "AgreementNumber";
            visible: 0;
            options_title: locked;
          }
        }
      }
      variable Q_MAP02
      {
        datatype: number;
        frequency: document;
        formula: (Q_MAP02_ENTEREDREQUIREDVARS=Q_MAP02_REQUIREDVARS);
        data_options: unscalable;
        displaytype: select;
        title: "Facility";
        locked: 1;
        visible: 1;
        choices: "0:Complete.|1:Not complete.";
        options_title: locked;
        options: locked;
        variable Q_MAP02_WARNING
        {
          datatype: string;
          frequency: document;
          formula: EvaluateAsString(Q_WARNING_GLOBAL[1]);
          data_options: unscalable;
          title: "Warning voor map";
          top_blanklines: 1;
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
        variable Q_MAP02_INFO
        {
          datatype: string;
          frequency: document;
          formula: EvaluateAsString(If(Q_MAP02[1]=0,&"not all required questions in this step are completed. [BR][/BR]Mandatory questions are marked with a *.",&""));
          data_options: unscalable;
          title: "Info bij stap";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
        variable Q_MAP02_VALIDATION
        {
          datatype: string;
          frequency: document;
          formula: EvaluateAsString(Q_GLOBAL_VALIDATION);
          data_options: unscalable;
          title: "Validatie stap";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
        variable Q_MAP02_PARAGRAAF01
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Facility";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
          tuple FacilityView refers to Facility_tpPrincipalLimit
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: currency;
            title: EvaluateAsString(Facility_tpName[1]);
            locked: 1;
            visible: 1;
            options_title: locked;
            options: locked;
            variable FacilityView_tpName refers to Facility_tpName
            {
              datatype: string;
              frequency: document;
              data_options: unscalable;
              title: "Name";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpID refers to Facility_tpID
            {
              datatype: string;
              frequency: document;
              data_options: unscalable;
              title: "Accountnumber";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpType refers to Facility_tpType
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: select;
              title: "Type";
              locked: 1;
              visible: 1;
              choices: "0:Unknown|1:Loan/Guarantee|2:Current account";
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpPrincipalLimit refers to Facility_tpPrincipalLimit
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Principle / Limit";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpProductduration refers to Facility_tpProductduration
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              fixed_decimals: 0;
              title: "Duration (months)";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpPD refers to Facility_tpPD
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 4;
              title: "Probability of Default (Corrected for maturity)";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpEAD refers to Facility_tpEAD
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Exposure At Default";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpEL refers to Facility_tpEL
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Expected Loss";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView3_tpProductSelected refers to Facility_tpProductSelected
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: select;
              locked: 1;
              visible: 1;
              choices: "0:There is no product selected for this facility|1:";
              options_title: locked;
              options: locked;
            }
            variable FacilityView_AllocatedCollateralTotal refers to Facility_tpAllocatedColTotal
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Total collaterals allocated to facility (direct and indirect)";
              top_separator: 1;
              display_options: displayAsSummation;
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpLGD refers to Facility_tpLGD
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Loss Given Default";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
          }
        }
        variable Q_MAP02_HULPVARIABELEN
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Hulpvariabelen";
          locked: 1;
          visible: 0;
          options_title: locked;
          options: locked;
          variable Q_MAP02_REQUIREDVARS
          {
            datatype: number;
            frequency: document;
            formula: 1;
            displaytype: currency;
            title: "Aantal verplichte velden (1)";
            top_blanklines: 1;
            locked: 1;
            visible: 0;
            options_title: locked;
            options: locked;
          }
          variable Q_MAP02_ENTEREDREQUIREDVARS
          {
            datatype: number;
            frequency: document;
            formula: 1;
            displaytype: currency;
            title: "Aantal ingevulde verplichte velden (1)";
            locked: 1;
            visible: 0;
            options_title: locked;
            options: locked;
          }
        }
      }
      variable Q_MAP07
      {
        datatype: number;
        frequency: document;
        formula: (Q_MAP07_ENTEREDREQUIREDVARS=Q_MAP07_REQUIREDVARS);
        data_options: unscalable;
        displaytype: select;
        title: "Interest rates";
        locked: 1;
        visible: 1;
        choices: "0:Complete.|1:Not complete.";
        options_title: locked;
        options: locked;
        variable Q_MAP07_WARNING
        {
          datatype: string;
          frequency: document;
          formula: EvaluateAsString(Q_WARNING_GLOBAL[1]);
          data_options: unscalable;
          title: "Warning voor map";
          top_blanklines: 1;
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
        variable Q_MAP07_INFO
        {
          datatype: string;
          frequency: document;
          formula: EvaluateAsString(If(Q_MAP07[1]=0,&"not all required questions in this step are completed. [BR][/BR]Mandatory questions are marked with a *.",&""));
          data_options: unscalable;
          title: "Info bij stap";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
        variable Q_MAP07_VALIDATION
        {
          datatype: string;
          frequency: document;
          formula: EvaluateAsString(Q_GLOBAL_VALIDATION);
          data_options: unscalable;
          title: "Validatie stap";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
        variable Q_MAP07_PARAGRAAF01
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Interest rates (Calculated)";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
          variable LoanComplexity
          {
            datatype: number;
            frequency: document;
            formula: 2;
            inputRequired: 1;
            data_options: saveCalculatedValue,unscalable;
            displaytype: select;
            title: "Loan Complexity";
            hint: "Hinttekst met instructies van Triodos (Nog aan te leveren door Triodos)";
            top_blanklines: 1;
            visible: 1;
            choices: "1:Simple|2:Normal|3:Complex";
            options_title: locked;
          }
          tuple FacilityView2_tpCalculatedRate refers to Facility_tpCalculatedRate
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: EvaluateAsString(Facility_tpName[1]);
            locked: 1;
            visible: 1;
            link: Facility_tpCalculatedRate;
            options_title: locked;
            options: locked;
            variable FacilityView2_tpID refers to Facility_tpID
            {
              datatype: string;
              frequency: document;
              data_options: unscalable;
              title: "Accountnumber";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView2_tpFunding refers to Facility_tpFunding
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Cost of funding";
              visible: 1;
              options_title: locked;
            }
            variable FacilityView2_tpRiskPremium refers to Facility_tpRiskPremium
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Risk premium";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView2_tpProcessCostsPercentage refers to Facility_tpProcessCostsPercentage
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Process costs";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView2_tpReturnPercentage refers to Facility_tpReturnPercentage
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Return (%)";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView3_tpCalculatedRate refers to Facility_tpCalculatedRate
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Calculated rate";
              top_separator: 1;
              display_options: displayAsSummation;
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpProductSelected refers to Facility_tpProductSelected
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: select;
              locked: 1;
              visible: 1;
              choices: "0:There is no product selected for this facility|1:";
              options_title: locked;
              options: locked;
            }
          }
        }
        variable Q_MAP07_PARAGRAAF02
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Interest rates (Used)";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
          tuple FacilityView_tpUsedRate refers to Facility_tpUsedRate
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: EvaluateAsString(Facility_tpName[1]);
            visible: 1;
            link: Facility_tpUsedRate;
            options_title: locked;
            variable FacilityView3_tpID refers to Facility_tpID
            {
              datatype: string;
              frequency: document;
              data_options: unscalable;
              title: "Accountnumber";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpFunding refers to Facility_tpFunding
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Cost of funding";
              visible: 1;
              options_title: locked;
            }
            variable FacilityView_tpRiskPremium refers to Facility_tpRiskPremium
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Risk premium";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpProcessCostsPercentage refers to Facility_tpProcessCostsPercentage
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Process costs";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpReturnPercentage refers to Facility_tpReturnPercentage
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Return (%)";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView2_tpUsedRate refers to Facility_tpUsedRate
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Used rate";
              top_separator: 1;
              display_options: displayAsSummation;
              visible: 1;
              options_title: locked;
            }
            variable FacilityView2_tpProductSelected refers to Facility_tpProductSelected
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: select;
              locked: 1;
              visible: 1;
              choices: "0:There is no product selected for this facility|1:";
              options_title: locked;
              options: locked;
            }
            variable FacilityView_Leeg refers to Facility_Leeg
            {
              datatype: none;
              frequency: none;
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpProductInterestRateFunding refers to Facility_tpProductInterestRateFunding
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 4;
              title: EvaluateAsString("Funding - "&Facility_tpProductTypePeriodicity[1]);
              visible: 1;
              options_title: locked;
            }
            variable FacilityView_tpProductInterestmargin refers to Facility_tpProductInterestmargin
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Margin";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView3_tpUsedRate refers to Facility_tpUsedRate
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Used rate";
              top_separator: 1;
              display_options: displayAsSummation;
              visible: 1;
              options_title: locked;
            }
            variable FacilityView_Leeg3 refers to Facility_Leeg3
            {
              datatype: none;
              frequency: none;
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpInterestMargin refers to Facility_tpInterestMargin
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Interest margin";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable -FacilityView_tpProcessCostsAbsolute refers to Facility_tpProcessCostsAbsolute
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Process costs";
              hint: "Fees will be deducted";
              visible: 1;
              options_title: locked;
            }
            variable -FacilityView2_tpEL refers to Facility_tpEL
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Expected Loss";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable -FacilityView_tpTax refers to Facility_tpTax
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Taxes";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable -FacilityView_tpCapitalCostsAbsolute refers to Facility_tpCapitalCostsAbsolute
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Capital costs";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpReturnAbsolute refers to Facility_tpReturnAbsolute
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              fixed_decimals: 0;
              title: "Return (Absolute)";
              top_separator: 1;
              display_options: displayAsSummation;
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpRAROC refers to Facility_tpRAROC
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "RAROC";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
          }
        }
        variable Q_MAP07_PARAGRAAF05
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Fees";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
          tuple FacilityView_tpFEE refers to Facility_tpFEE
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: currency;
            fixed_decimals: 2;
            title: EvaluateAsString(Facility_tpName[1]);
            locked: 1;
            visible: 1;
            options_title: locked;
            options: locked;
            variable FacilityView4_tpID refers to Facility_tpID
            {
              datatype: string;
              frequency: document;
              data_options: unscalable;
              title: "Accountnumber";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpArrangementFee refers to Facility_tpArrangementFee
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 2;
              title: "Arrangement fee";
              visible: 1;
              options_title: locked;
            }
            variable FacilityView_tpManagingFee refers to Facility_tpManagingFee
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 2;
              title: "Managing fee (per quarter of duration)";
              visible: 1;
              options_title: locked;
            }
            variable FacilityView_tpManagingFeeFacility refers to Facility_tpManagingFeeFacility
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 2;
              title: "Total Managing fee facility";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilityView_tpFacilityFee refers to Facility_tpFacilityFee
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 2;
              title: "Facility fee";
              visible: 1;
              options_title: locked;
            }
            variable FacilityView_tpUpfrontFee refers to Facility_tpUpfrontFee
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 2;
              title: "Upfront fee";
              visible: 1;
              options_title: locked;
            }
          }
        }
        variable Q_MAP07_HULPVARIABELEN
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Hulpvariabelen";
          locked: 1;
          visible: 0;
          options_title: locked;
          options: locked;
          variable Q_MAP07_REQUIREDVARS
          {
            datatype: number;
            frequency: document;
            formula: Count(X,SelectDescendants(Q_MAP07, Q_MAP07_HULPVARIABELEN),InputRequired(X));
            displaytype: currency;
            title: "Aantal verplichte velden (1)";
            top_blanklines: 1;
            locked: 1;
            visible: 0;
            options_title: locked;
            options: locked;
          }
          variable Q_MAP07_ENTEREDREQUIREDVARS
          {
            datatype: number;
            frequency: document;
            formula: Count(X,SelectDescendants(Q_MAP07, Q_MAP07_HULPVARIABELEN),InputRequired(X) and DataAvailable(X));
            displaytype: currency;
            title: "Aantal ingevulde verplichte velden (1)";
            locked: 1;
            visible: 0;
            options_title: locked;
            options: locked;
          }
        }
      }
      variable Q_MAP00
      {
        datatype: number;
        frequency: document;
        formula: (Q_MAP00_ENTEREDREQUIREDVARS=Q_MAP00_REQUIREDVARS);
        data_options: unscalable;
        displaytype: select;
        title: "Data imported from Force";
        locked: 1;
        visible: 0;
        choices: "0:Complete.|1:Not complete.";
        options_title: locked;
        options: locked;
        variable Q_MAP00_WARNING
        {
          datatype: string;
          frequency: document;
          formula: EvaluateAsString(Q_WARNING_GLOBAL[1]);
          data_options: unscalable;
          title: "Warning voor map";
          top_blanklines: 1;
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
        variable Q_MAP00_INFO
        {
          datatype: string;
          frequency: document;
          data_options: unscalable;
          title: "Info bij stap";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
        variable Q_MAP00_VALIDATION
        {
          datatype: string;
          frequency: document;
          formula: EvaluateAsString(If(Q_MAP00[1]=0,&"not all required questions in this step are completed. [BR][/BR]Mandatory questions are marked with a *.",&""));
          data_options: unscalable;
          title: "Validatie stap";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
        variable Q_MAPRATING
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Rating";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
          variable IMPORT_Rating
          {
            datatype: number;
            frequency: document;
            inputRequired: 1;
            data_options: unscalable;
            displaytype: select;
            title: "Rating";
            top_blanklines: 1;
            visible: 1;
            choices: "14:14|13:13|12:12|11:11|10:10|9:9|8:8|7:7|6:6|5:5|4:4|3:3|2:2|1:1";
            options_title: locked;
          }
          variable IMPORT_PD
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(IMPORT_PD_FIXED), IMPORT_PD_FIXED, MatrixLookup("TRIODOS_Parameters.xls","Rating2PD",IMPORT_Rating,1));
            inputRequired: 1;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 4;
            title: "Probability of Default";
            locked: 1;
            visible: 1;
            options_title: locked;
            options: locked;
          }
        }
        variable Q_MAP00_PARAGRAAF01
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Collaterals (not allocated to facilities)";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
          tuple Collateral
          {
            frequency: none;
            title: "Collateral";
            visible: 1;
            options_title: locked;
            variable Collateral_tpID
            {
              datatype: string;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              title: "ID";
              top_blanklines: 1;
              visible: 1;
              options_title: locked;
            }
            variable Collateral_tpStatusName
            {
              datatype: string;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              title: "Status";
              visible: 1;
              options_title: locked;
            }
            variable Collateral_tpStatus
            {
              datatype: number;
              frequency: document;
              formula: 3;
              data_options: saveCalculatedValue,unscalable;
              displaytype: select;
              title: "Status";
              visible: 1;
              choices: "1:Existing|2:New|3:Modification|4:Expired";
              options_title: locked;
            }
            variable Collateral_tpName
            {
              datatype: string;
              frequency: document;
              data_options: unscalable;
              title: "Description";
              visible: 1;
              options_title: locked;
            }
            variable Collateral_tpType
            {
              datatype: string;
              frequency: document;
              data_options: unscalable;
              title: "Type";
              visible: 1;
              options_title: locked;
            }
            variable Collateral_tpRegistrationValue
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Mortgage registration";
              visible: 1;
              options_title: locked;
            }
            variable Collateral_tpRank
            {
              datatype: number;
              frequency: document;
              data_options: unscalable;
              fixed_decimals: 0;
              title: "Rank";
              visible: 1;
              options_title: locked;
            }
            variable Collateral_tpDiscount
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Prior amount";
              visible: 1;
              options_title: locked;
            }
            variable Collateral_tpValue
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Collateral value";
              visible: 1;
              options_title: locked;
            }
            variable Collateral_tpEconomicCapitalCoverage
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              fixed_decimals: 0;
              title: "EC Value";
              visible: 1;
              options_title: locked;
            }
            variable Collateral_tpRegulatoryCapitalCoverage
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              fixed_decimals: 0;
              title: "RC Value";
              visible: 1;
              options_title: locked;
            }
            variable Collateral_tpAllocationPercentage
            {
              datatype: number;
              frequency: document;
              formula: 1;
              data_options: saveCalculatedValue,unscalable;
              displaytype: percentage;
              fixed_decimals: 0;
              title: "Allocation percentage";
              visible: 1;
              options_title: locked;
            }
            variable Collateral_tpRecoveryValueEC
            {
              datatype: number;
              frequency: document;
              formula: If((Collateral_tpStatus<=0) or (Collateral_tpStatus=9),NA,If(Collateral_tpRegistrationValue=NA, Collateral_tpEconomicCapitalCoverage*Collateral_tpAllocationPercentage   , Min(Collateral_tpRegistrationValue,  Collateral_tpEconomicCapitalCoverage*Collateral_tpAllocationPercentage   )));
              data_options: saveCalculatedValue,unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Allocated collateral value (EC)";
              locked: 1;
              visible: 1;
              link: Collateral_tpValue;
              options_title: locked;
              options: locked;
            }
            variable Collateral_tpRecoveryValueRC
            {
              datatype: number;
              frequency: document;
              formula: If((Collateral_tpStatus<=0) or (Collateral_tpStatus=9),NA,If(Collateral_tpRegistrationValue=NA, Collateral_tpRegulatoryCapitalCoverage*Collateral_tpAllocationPercentage , Min(Collateral_tpRegistrationValue,  Collateral_tpRegulatoryCapitalCoverage*Collateral_tpAllocationPercentage )));
              data_options: saveCalculatedValue,unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Allocated collateral value (RC)";
              locked: 1;
              visible: 1;
              link: Collateral_tpValue;
              options_title: locked;
              options: locked;
            }
          }
          variable CollateralNotAllocatedTotal
          {
            datatype: number;
            frequency: document;
            formula: TupleSum(Collateral_tpRecoveryValueEC);
            data_options: saveCalculatedValue,unscalable;
            displaytype: currency;
            fixed_decimals: 0;
            title: "Total collaterals (not allocated to facilities)";
            top_separator: 1;
            display_options: displayAsSummation;
            locked: 1;
            visible: 1;
            options_title: locked;
            options: locked;
          }
        }
        variable Q_MAP00_PARAGRAAF02
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Facilities";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
          tuple Facility
          {
            frequency: none;
            title: "Facility";
            visible: 1;
            options_title: locked;
            variable Facility_tpID
            {
              datatype: string;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              title: "Accountnumber";
              top_blanklines: 1;
              visible: 1;
              options_title: locked;
            }
            variable Facility_TopLevelParentReferenceNumber
            {
              datatype: string;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              title: "TopLevelParentReferenceNumber";
              visible: 1;
              options_title: locked;
            }
            variable Facility_tpStatusName
            {
              datatype: string;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              title: "Status";
              visible: 1;
              options_title: locked;
            }
            variable Facility_tpStatus
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              displaytype: select;
              title: "Status";
              visible: 1;
              choices: "1:Existing|2:New|3:Modification|4:Expired";
              options_title: locked;
            }
            variable Facility_tpName
            {
              datatype: string;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              title: "Name";
              visible: 1;
              options_title: locked;
            }
            variable Facility_tpLender
            {
              datatype: string;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              title: "Lender";
              visible: 1;
              options_title: locked;
            }
            variable Facility_tpType
            {
              datatype: number;
              frequency: document;
              formula: MatrixLookup("TRIODOS_InterestParameters.xls","LoanType",Facility_tpProductname,1);
              data_options: saveCalculatedValue,unscalable;
              displaytype: select;
              title: "Type";
              visible: 1;
              choices: "0:Unknown|1:Loan/Guarantee|2:Current account";
              options_title: locked;
            }
            variable Facility_tpPrincipalLimit
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Principle / Limit";
              visible: 1;
              options_title: locked;
            }
            variable Facility_tpMaturity
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              fixed_decimals: 0;
              title: "Duration (months)";
              visible: 1;
              options_title: locked;
            }
            variable Facility_tpNumberOfQuarters
            {
              datatype: number;
              frequency: document;
              formula: (Facility_tpProductduration/3);
              data_options: saveCalculatedValue,unscalable;
              fixed_decimals: 2;
              title: "Number of quarters";
              visible: 1;
              options_title: locked;
            }
            variable Facility_tpRepaymentType
            {
              datatype: number;
              frequency: document;
              formula: MatrixLookup("TRIODOS_InterestParameters.xls","Redemptiontype",Facility_tpProductredemptionDetailsRedemptionType,1);
              data_options: saveCalculatedValue,unscalable;
              displaytype: select;
              title: "Repayment type";
              visible: 1;
              choices: "0:Unknown|1:Linear|2:Interest only|3:Annuity";
              options_title: locked;
            }
            variable Facility_tpAllocatedColTotal
            {
              datatype: number;
              frequency: document;
              formula: If((&Q_MODELVERSION_FIXED < "2") and (Q_STATUS=1), Facility_CollateralTotal, NA);
              data_options: saveCalculatedValue,unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Total collaterals allocated to facility (direct and indirect)";
              visible: 1;
              options_title: locked;
            }
            variable Facility_tpRateImported
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "Interest rate from imported from Force";
              visible: 1;
              options_title: locked;
            }
            variable Facility_tpProduct
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue;
              displaytype: currency;
              title: EvaluateAsString("Product ");
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
              variable Facility_tpProductReferenceNumber
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "productReferenceNumber";
                top_blanklines: 1;
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductname
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "productname";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductstatus
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "Status";
                hint: "NEW / MODIFIED / UNMODIFIED / TOEXPIRE";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductSelected
              {
                datatype: number;
                frequency: document;
                formula: If(MatrixLookup("TRIODOS_InterestParameters.xls","ProductSelected",Facility_tpProductstatus,1)=1,0,1);
                data_options: saveCalculatedValue,unscalable;
                displaytype: select;
                title: "ProductSelected Indication";
                locked: 1;
                visible: 1;
                choices: "0:There is no product selected for this facility|1:";
                options_title: locked;
                options: locked;
              }
              variable Facility_tpProductstartDate
              {
                datatype: number;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                displaytype: date;
                title: "Start Date";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductduration
              {
                datatype: number;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                fixed_decimals: 0;
                title: "Duration (months)";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductinterestDetailsInterestType
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "Interest - InterestType";
                hint: "Euribors / IRS / Base";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductinterestDetailsFixedInterestPeriod
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "Interest - FixedInterestPeriod";
                hint: "Looptijd in maanden";
                visible: 1;
                options_title: locked;
              }
              variable Facility_Tpproductinterestdetailsperiodicity
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "Interest - Periodicity";
                hint: "monthly / quarterly / yearly";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductinterestDetailsInterestProductName
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "Interest - InterestProductName";
                hint: "Looptijd in uitgeschreven tekst";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductredemptionDetailsRedemptionType
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "redemption - RedemptionType";
                hint: "Interest_only, Linear,Annuity";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductredemptionDetailsFirstRedemptionAfterXMonths
              {
                datatype: number;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                fixed_decimals: 0;
                title: "redemption - FirstRedemptionAfterXMonths";
                visible: 1;
                options_title: locked;
              }
              variable Facility_Tpproductredemptiondetailsperiodicity
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "redemption - Periodicity";
                hint: "monthly / quarterly / yearly";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductuptakeDetailsUptakeType
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "uptake - UptakeType";
                hint: "ONE_TIME,FIXED_TERMS,REVOLVING,IRREGULAR_SCHEDULE";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductuptakeDetailsUptakeFrequency
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "uptake - UptakeFrequency";
                hint: "Daily, WEEKLy,MONTHLY,Quarterly,YEARLY";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductTypePeriodicity
              {
                datatype: string;
                frequency: document;
                formula: EvaluateAsString(Facility_tpProductinterestDetailsInterestType&" "&Facility_tpProductinterestDetailsInterestProductName);
                data_options: saveCalculatedValue,unscalable;
                title: "Interest Type + Periodicity";
                hint: "Deze wordt gebruikt om de rente tarief op te zoeken.";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductInterestRateFunding
              {
                datatype: number;
                frequency: document;
                formula: If(DataEntered(Facility_tpProductInterestRateFunding_FIXED), Facility_tpProductInterestRateFunding_FIXED,OnERorNA(MatrixLookup("TRIODOS_InterestParameters.xls","InterestParameters",&Facility_tpProductTypePeriodicity,1),NA));
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 4;
                title: EvaluateAsString("Funding - "&Facility_tpProductTypePeriodicity[1]);
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductInterestRateFunding_FIXED
              {
                datatype: number;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 4;
                title: EvaluateAsString("Funding (FIXED) - "&Facility_tpProductTypePeriodicity[1]);
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpProductInterestmargin
              {
                datatype: number;
                frequency: document;
                formula: Facility_tpUsedRate - Facility_tpProductInterestRateFunding;
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 3;
                title: "Margin";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
            }
            variable Facility_tpRisico
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue;
              displaytype: currency;
              title: EvaluateAsString("Risk ");
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
              variable Facility_tpPD1Year
              {
                datatype: number;
                frequency: document;
                formula: PD;
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 4;
                title: "Probability of Default (1 Year)";
                top_blanklines: 1;
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpAverageDuration
              {
                datatype: number;
                frequency: document;
                formula: OnER(MAX(1,MIN(DurationMaximumAverage,If(Facility_tpType=2,1,IF(Facility_tpRepaymentType=2, Round((Facility_tpProductduration/12),0)  ,Round((Facility_tpProductduration/12)/2,0))))),NA);
                data_options: saveCalculatedValue,unscalable;
                fixed_decimals: 2;
                title: "Average duration facility";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpPD
              {
                datatype: number;
                frequency: document;
                formula: If(DataEntered(Facility_tpPD_FIXED), Facility_tpPD_FIXED,OnER(MatrixLookup("TRIODOS_Parameters.xls","PDDurationCorrection",Rating,Facility_tpAverageDuration),1));
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 4;
                title: "Probability of Default (Corrected for maturity)";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpPD_FIXED
              {
                datatype: number;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 4;
                title: "Probability of Default (Corrected for maturity) (FIXED)";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpLGDUncured
              {
                datatype: number;
                frequency: document;
                formula: OnEr((Facility_tpTotal - (Facility_tpAllocatedColTotal * Facility_tpLGDDF )) / Facility_tpTotal *( 1 - UnsecuredRecoveryRate), NA);
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 3;
                title: "Loss Given Default (Uncured)";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpLGDDF
              {
                datatype: number;
                frequency: document;
                formula: OnEr ( 1 / (1 + AverageContractRate ) ^ AverageTimeDefault ,NA);
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 3;
                title: "Loss Given Default (Discount factor)";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpLGD
              {
                datatype: number;
                frequency: document;
                formula: Min(LGDMaximum,Max(LGDMinimum, (1 - CureRate) *  Facility_tpLGDUncured + IndirectCost));
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 3;
                title: "Loss Given Default";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpMaxLoss
              {
                datatype: number;
                frequency: document;
                formula: If((&Q_MODELVERSION_FIXED < "2") and (Q_STATUS=1), Max(0, Facility_tpPrincipalLimit - Facility_tpAllocatedColTotal), NA);
                data_options: saveCalculatedValue,unscalable;
                fixed_decimals: 0;
                title: "Max Loss";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpEAD
              {
                datatype: number;
                frequency: document;
                formula: Facility_tpPrincipalLimit;
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Exposure At Default";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable Facility_tpEC
              {
                datatype: number;
                frequency: document;
                formula: Max(0,OnER(Facility_tpAverageDurationEL*(Facility_tpEAD*Facility_tpLGD*CumNormal((InvNormal(Facility_tpPD)+(Correlation^0.5)*InvNormal(ConfidenceLevel))/((1-Correlation)^0.5))-Facility_tpEL) * 1.06 ,NA));
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Economic Capital Credit Risk";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable Facility_tpECOperationalRisk
              {
                datatype: number;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Economic Capital Operational Risk";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable Facility_tpECTotal
              {
                datatype: number;
                frequency: document;
                formula: Facility_tpEC+Facility_tpECOperationalRisk;
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Economic Capital Total";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
            }
            variable Facility_tpRate
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              displaytype: percentage;
              fixed_decimals: 1;
              title: EvaluateAsString("Rate ");
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
              variable Facility_tpFunding
              {
                datatype: number;
                frequency: document;
                formula: CostOfFundingPerc;
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 3;
                title: "Cost of funding";
                top_blanklines: 1;
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpRiskPremium
              {
                datatype: number;
                frequency: document;
                formula: If(Facility_tpProductSelected=1,OnER(((HurdleRate*Facility_tpEC)-(1-Taxrate)*(Facility_tpFunding*Facility_tpEC-(Facility_tpEL)))/(Facility_tpPrincipalLimit*(1-Taxrate)),NA),NA);
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 3;
                title: "Risk premium";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable Facility_tpProcessCostsPercentage
              {
                datatype: number;
                frequency: document;
                formula: OnER(Facility_tpUsedRate-Facility_tpRiskPremium-Facility_tpReturnPercentage-Facility_tpFunding,NA);
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 3;
                title: "Process costs";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable Facility_tpReturnPercentage
              {
                datatype: number;
                frequency: document;
                formula: OnER((Facility_tpReturnAbsolute)/(Facility_tpPrincipalLimit*(1-Taxrate)),NA);
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 3;
                title: "Return (%)";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable Facility_tpCalculatedRate
              {
                datatype: number;
                frequency: document;
                formula: If(Facility_tpProductSelected=1,OnER(((RendementseisBank*Facility_tpEC)-(1-Taxrate)*(Facility_tpFunding*Facility_tpEC-(Facility_tpEL+Facility_tpProcessCostsAbsolute)))/(Facility_tpPrincipalLimit*(1-Taxrate))+Facility_tpFunding,NA),NA);
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 3;
                title: "Calculated rate";
                top_separator: 1;
                display_options: displayAsSummation;
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable Facility_tpUsedRate
              {
                datatype: number;
                frequency: document;
                formula: If((Facility_tpStatus=1 or Facility_tpStatus=4),Facility_tpRateImported,Facility_tpCalculatedRate);
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 3;
                title: "Used rate";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpPremium
              {
                datatype: number;
                frequency: document;
                formula: Facility_tpUsedRate - Facility_tpFunding;
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 3;
                title: "Premium";
                hint: "Used rate minus Cost of funding";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpPrintedRate
              {
                datatype: string;
                frequency: document;
                formula: EvaluateAsString(If(Facility_tpVariableRate=1,&Facility_tpProductTypePeriodicity[1]&" +  "&Str((100*Facility_tpProductInterestmargin),2,3)&" %", &Str((100*Facility_tpUsedRate),2,3)&" %"));
                data_options: saveCalculatedValue,unscalable;
                title: "Printed rate";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpVariableRate
              {
                datatype: number;
                frequency: document;
                formula: OnERorNA(MatrixLookup("TRIODOS_InterestParameters.xls","InterestParametersFixed",&Facility_tpProductinterestDetailsInterestType,1),0);
                data_options: saveCalculatedValue,unscalable;
                displaytype: select;
                title: "Variable or Fixed rate?";
                visible: 1;
                choices: "2:Fixed|1:Variable";
                options_title: locked;
              }
            }
            variable Facility_tpFEE
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: EvaluateAsString("Fees");
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
              variable Facility_tpArrangementFee
              {
                datatype: number;
                frequency: document;
                data_options: unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Arrangement fee";
                top_blanklines: 1;
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpManagingFee
              {
                datatype: number;
                frequency: document;
                data_options: unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Managing fee (per quarter of duration)";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpManagingFeeFacility
              {
                datatype: number;
                frequency: document;
                formula: (Facility_tpManagingFee*Facility_tpNumberOfQuarters);
                data_options: unscalable;
                displaytype: currency;
                fixed_decimals: 2;
                title: "Total Managing fee facility";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable Facility_tpFacilityFee
              {
                datatype: number;
                frequency: document;
                data_options: unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Facility fee";
                visible: 1;
                options_title: locked;
              }
              variable Facility_tpUpfrontFee
              {
                datatype: number;
                frequency: document;
                data_options: unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Upfront fee";
                visible: 1;
                options_title: locked;
              }
            }
            variable Facility_tpRendement2
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Return";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
              variable Facility_tpInterestMargin
              {
                datatype: number;
                frequency: document;
                formula: OnER((Facility_tpUsedRate-Facility_tpFunding)*Facility_tpPrincipalLimit,NA);
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Interest margin";
                top_blanklines: 1;
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable -Facility_tpProcessCostsAbsolute
              {
                datatype: number;
                frequency: document;
                formula: Max(0,OnER(ProcessCostsModelPercentage*Facility_tpPrincipalLimit - Facility_tpArrangementFee - Facility_tpManagingFeeFacility - Facility_tpFacilityFee - Facility_tpUpfrontFee,NA));
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Process costs";
                hint: "Fees will be deducted";
                visible: 1;
                options_title: locked;
              }
              variable -Facility_tpEL
              {
                datatype: number;
                frequency: document;
                formula: OnNEG(OnER(Facility_tpAverageDurationEL*Facility_tpEAD*Facility_tpLGD*Facility_tpPD,NA),0);
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Expected Loss";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable -Facility_tpTax
              {
                datatype: number;
                frequency: document;
                formula: Max(0,(Facility_tpInterestMargin-Facility_tpProcessCostsAbsolute-Facility_tpEL)*Taxrate);
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Taxes";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable -Facility_tpCapitalCostsAbsolute
              {
                datatype: number;
                frequency: document;
                formula: OnER(Facility_tpEC*(HurdleRate-Facility_tpFunding*(1-Taxrate)),NA);
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Capital costs";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable Facility_tpReturnAbsolute
              {
                datatype: number;
                frequency: document;
                formula: OnER(Facility_tpInterestMargin-Facility_tpProcessCostsAbsolute-Facility_tpEL-Facility_tpTax-Facility_tpCapitalCostsAbsolute,NA);
                data_options: saveCalculatedValue,unscalable;
                fixed_decimals: 0;
                title: "Return (Absolute)";
                top_separator: 1;
                display_options: displayAsSummation;
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable Facility_tpRAROC
              {
                datatype: number;
                frequency: document;
                formula: If(Facility_tpProductSelected=1,OnER((Facility_tpInterestMargin-Facility_tpProcessCostsAbsolute-Facility_tpEL-Facility_tpTax+Facility_tpEC*Facility_tpFunding*(1-Taxrate))/Facility_tpEC,NA),NA);
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 3;
                title: "RAROC";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
            }
            variable Facility_tpOther
            {
              datatype: none;
              frequency: none;
              title: "Other";
              bottom_separator: 1;
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
              variable Facility_tpAverageDurationEC
              {
                datatype: number;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                fixed_decimals: 2;
                title: "Durationfactors EC";
                top_blanklines: 1;
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable Facility_tpAverageDurationEL
              {
                datatype: number;
                frequency: document;
                formula: 1;
                data_options: saveCalculatedValue,unscalable;
                fixed_decimals: 2;
                title: "Durationfactors EL";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
              variable Facility_tpTotal
              {
                datatype: number;
                frequency: document;
                formula: If((Facility_tpStatus>0) and (Facility_tpStatus<9),Facility_tpPrincipalLimit,NA);
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Total";
                locked: 1;
                visible: 1;
                options_title: locked;
                options: locked;
              }
            }
            variable Facility_Leeg
            {
              datatype: none;
              frequency: none;
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable Facility_Leeg3
            {
              datatype: none;
              frequency: none;
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            tuple Facility_Collateral
            {
              frequency: none;
              title: "Facility collateral";
              visible: 1;
              options_title: locked;
              variable Facility_Collateral_tpID
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "ID";
                top_blanklines: 1;
                visible: 1;
                options_title: locked;
              }
              variable Facility_Collateral_tpStatusName
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "Status";
                visible: 1;
                options_title: locked;
              }
              variable Facility_Collateral_tpStatus
              {
                datatype: number;
                frequency: document;
                formula: 3;
                data_options: saveCalculatedValue,unscalable;
                displaytype: select;
                title: "Status";
                visible: 1;
                choices: "1:Existing|2:New|3:Modification|4:Expired";
                options_title: locked;
              }
              variable Facility_Collateral_tpName
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "Description";
                visible: 1;
                options_title: locked;
              }
              variable Facility_Collateral_tpType
              {
                datatype: string;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                title: "Type";
                visible: 1;
                options_title: locked;
              }
              variable Facility_Collateral_tpRegistrationValue
              {
                datatype: number;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Mortgage registration";
                visible: 1;
                options_title: locked;
              }
              variable Facility_Collateral_tpRank
              {
                datatype: number;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                fixed_decimals: 0;
                title: "Rank";
                visible: 1;
                options_title: locked;
              }
              variable Facility_Collateral_tpDiscount
              {
                datatype: number;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Discount";
                visible: 1;
                options_title: locked;
              }
              variable Facility_Collateral_tpValue
              {
                datatype: number;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Collateral value";
                visible: 1;
                options_title: locked;
              }
              variable Facility_Collateral_tpEconomicCapitalCoverage
              {
                datatype: number;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                fixed_decimals: 0;
                title: "EC Value";
                visible: 1;
                options_title: locked;
              }
              variable Facility_Collateral_tpRegulatoryCapitalCoverage
              {
                datatype: number;
                frequency: document;
                data_options: saveCalculatedValue,unscalable;
                fixed_decimals: 0;
                title: "RC Value";
                visible: 1;
                options_title: locked;
              }
              variable Facility_Collateral_tpAllocationPercentage
              {
                datatype: number;
                frequency: document;
                formula: 1;
                data_options: saveCalculatedValue,unscalable;
                displaytype: percentage;
                fixed_decimals: 0;
                title: "Allocation percentage (directly allocated)";
                visible: 1;
                options_title: locked;
              }
              variable Facility_Collateral_tpRecoveryValueEC
              {
                datatype: number;
                frequency: document;
                formula: If((Facility_Collateral_tpStatus<=0) or (Facility_Collateral_tpStatus=9),NA, If(Facility_Collateral_tpRegistrationValue=NA, Facility_Collateral_tpEconomicCapitalCoverage*Facility_Collateral_tpAllocationPercentage  , Min(Facility_Collateral_tpRegistrationValue,Facility_Collateral_tpEconomicCapitalCoverage*Facility_Collateral_tpAllocationPercentage)));
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Allocated collateral value (EC)";
                visible: 1;
                link: Facility_Collateral_tpValue;
                options_title: locked;
              }
              variable Facility_Collateral_tpRecoveryValueRC
              {
                datatype: number;
                frequency: document;
                formula: If((Facility_Collateral_tpStatus<=0) or (Facility_Collateral_tpStatus=9),NA, If(Facility_Collateral_tpRegistrationValue=NA, Facility_Collateral_tpRegulatoryCapitalCoverage*Facility_Collateral_tpAllocationPercentage, Min(Facility_Collateral_tpRegistrationValue,Facility_Collateral_tpRegulatoryCapitalCoverage*Facility_Collateral_tpAllocationPercentage)));
                data_options: saveCalculatedValue,unscalable;
                displaytype: currency;
                fixed_decimals: 0;
                title: "Allocated collateral value (RC)";
                visible: 1;
                link: Facility_Collateral_tpValue;
                options_title: locked;
              }
            }
            variable Facility_CollateralFacility
            {
              datatype: number;
              frequency: document;
              formula: TupleSum(Facility_Collateral_tpRecoveryValueEC);
              data_options: saveCalculatedValue,unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Collaterals assigned to facility";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable Facility_CollateralNotAllocated
            {
              datatype: number;
              frequency: document;
              formula: OnEr(CollateralNotAllocatedTotal * (Facility_tpTotal / FacilityTotal ),NA);
              data_options: saveCalculatedValue,unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Collaterals not direct allocated to facility";
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable FacilitySub25
            {
              datatype: number;
              frequency: document;
              data_options: saveCalculatedValue,unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Total collaterals allocated to facility (direct and indirect)";
              top_separator: 1;
              display_options: displayAsSummation;
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
            variable Facility_CollateralTotal
            {
              datatype: number;
              frequency: document;
              formula: Facility_CollateralFacility + Facility_CollateralNotAllocated;
              data_options: saveCalculatedValue,unscalable;
              displaytype: currency;
              fixed_decimals: 0;
              title: "Total collaterals";
              top_separator: 1;
              display_options: displayAsSummation;
              locked: 1;
              visible: 1;
              options_title: locked;
              options: locked;
            }
          }
          variable TotalArrangementfee
          {
            datatype: number;
            frequency: document;
            formula: TupleSum(Facility_tpArrangementFee);
            data_options: saveCalculatedValue,unscalable;
            displaytype: currency;
            fixed_decimals: 0;
            title: "Total Arrangement fee";
            visible: 1;
            options_title: locked;
          }
          variable TotalManagingfeefacility
          {
            datatype: number;
            frequency: document;
            formula: TupleSum(Facility_tpManagingFeeFacility);
            data_options: saveCalculatedValue,unscalable;
            displaytype: currency;
            fixed_decimals: 0;
            title: "Total Managing fee";
            visible: 1;
            options_title: locked;
          }
          variable TotalFacilityfee
          {
            datatype: number;
            frequency: document;
            formula: TupleSum(Facility_tpFacilityFee);
            data_options: saveCalculatedValue,unscalable;
            displaytype: currency;
            fixed_decimals: 0;
            title: "Total Facility fee";
            visible: 1;
            options_title: locked;
          }
          variable TotalUpfrontfee
          {
            datatype: number;
            frequency: document;
            formula: TupleSum(Facility_tpUpfrontFee);
            data_options: saveCalculatedValue,unscalable;
            displaytype: currency;
            fixed_decimals: 0;
            title: "Total Upfront fee";
            visible: 1;
            options_title: locked;
          }
          variable TotalFees
          {
            datatype: number;
            frequency: document;
            formula: (TotalArrangementfee + TotalManagingfeefacility + TotalFacilityfee + TotalUpfrontfee);
            data_options: saveCalculatedValue,unscalable;
            displaytype: currency;
            fixed_decimals: 0;
            title: "Total Fees";
            visible: 1;
            options_title: locked;
          }
          variable TotalMaxLoss
          {
            datatype: number;
            frequency: document;
            formula: TupleSum(Facility_tpMaxLoss);
            data_options: saveCalculatedValue,unscalable;
            displaytype: currency;
            fixed_decimals: 0;
            title: "Total Max Loss";
            visible: 1;
            options_title: locked;
          }
          variable FacilityTotal
          {
            datatype: number;
            frequency: document;
            formula: TupleSum(Facility_tpTotal);
            data_options: saveCalculatedValue,unscalable;
            displaytype: currency;
            fixed_decimals: 0;
            title: "Total";
            top_separator: 1;
            display_options: displayAsSummation;
            locked: 1;
            visible: 1;
            options_title: locked;
            options: locked;
          }
          variable CollateralTotal
          {
            datatype: number;
            frequency: document;
            formula: TupleSum(Facility_tpAllocatedColTotal);
            data_options: saveCalculatedValue,unscalable;
            displaytype: currency;
            fixed_decimals: 0;
            title: "Total Collateral";
            visible: 1;
            options_title: locked;
          }
        }
        variable Assumptions
        {
          datatype: number;
          frequency: document;
          data_options: saveCalculatedValue;
          displaytype: currency;
          title: "Assumptions";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
          variable Branch
          {
            datatype: string;
            frequency: document;
            formula: EvaluateAsString(Case(Branchselection,[0:"BE_"|1:"NL_"|2:"UK_"]));
            data_options: saveCalculatedValue,unscalable;
            title: "Branch";
            top_blanklines: 1;
            locked: 1;
            visible: 1;
            options_title: locked;
            options: locked;
          }
          variable ConfidenceLevel
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(ConfidenceLevel_FIXED), ConfidenceLevel_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls",&Branch&"PricingParameters",2,1),0.9995));
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "Confidence Level";
            visible: 1;
            options_title: locked;
          }
          variable HurdleRate
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(HurdleRate_FIXED), HurdleRate_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls",&Branch&"PricingParameters",3,1),0.1));
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "Hurdle rate";
            hint: "Minimum acceptable rate of return";
            visible: 1;
            options_title: locked;
          }
          variable RendementseisBank
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(RendementseisBank_FIXED), RendementseisBank_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls",&Branch&"PricingParameters",4,1),0.18));
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "Targert return on equity";
            visible: 1;
            options_title: locked;
          }
          variable Taxrate
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(Taxrate_FIXED), Taxrate_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls",&Branch&"PricingParameters",5,1),0));
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "Tax rate";
            visible: 1;
            options_title: locked;
          }
          variable ProcessCostsModelPercentage
          {
            datatype: number;
            frequency: document;
            formula: OnER((InterestLowerLimit - (((FacilityTotal - LowerLimit)/(DeltaLimit))*InterestDelta))*LoanComplexityValue,NA);
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "Process cost";
            visible: 1;
            options_title: locked;
            variable LoanComplexityValue
            {
              datatype: number;
              frequency: document;
              formula: MatrixLookup("TRIODOS_Parameters.xls","LoanComplexity",LoanComplexity,1);
              data_options: saveCalculatedValue,unscalable;
              fixed_decimals: 0;
              title: "Loan Complexity Value";
              top_blanklines: 1;
              visible: 1;
              options_title: locked;
            }
            variable LowerLimit
            {
              datatype: number;
              frequency: document;
              formula: MatrixLookup("TRIODOS_Parameters.xls",&Branch&"OrganisationalCost",FacilityTotal,1);
              data_options: saveCalculatedValue,unscalable;
              fixed_decimals: 0;
              title: "LowerLimit";
              visible: 1;
              options_title: locked;
            }
            variable DeltaLimit
            {
              datatype: number;
              frequency: document;
              formula: MatrixLookup("TRIODOS_Parameters.xls",&Branch&"OrganisationalCost",FacilityTotal,3);
              data_options: saveCalculatedValue,unscalable;
              fixed_decimals: 0;
              title: "DeltaLimit";
              visible: 1;
              options_title: locked;
            }
            variable InterestLowerLimit
            {
              datatype: number;
              frequency: document;
              formula: MatrixLookup("TRIODOS_Parameters.xls",&Branch&"OrganisationalCost",FacilityTotal,4);
              data_options: saveCalculatedValue,unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "InterestLowerLimit";
              visible: 1;
              options_title: locked;
            }
            variable InterestDelta
            {
              datatype: number;
              frequency: document;
              formula: MatrixLookup("TRIODOS_Parameters.xls",&Branch&"OrganisationalCost",FacilityTotal,6);
              data_options: saveCalculatedValue,unscalable;
              displaytype: percentage;
              fixed_decimals: 3;
              title: "InterestDelta";
              visible: 1;
              options_title: locked;
            }
          }
          variable LGDMaximum
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(LGDMaximum_FIXED), LGDMaximum_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls",&Branch&"PricingParameters",1,1),1));
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "LGD Maximum";
            locked: 1;
            visible: 1;
            options_title: locked;
            options: locked;
          }
          variable LGDMinimum
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(LGDMinimum_FIXED), LGDMinimum_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls",&Branch&"PricingParameters",7,1),0.05));
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "LGD Minimum";
            locked: 1;
            visible: 1;
            options_title: locked;
            options: locked;
          }
          variable DurationMaximumAverage
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(DurationMaximumAverage_FIXED), DurationMaximumAverage_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls",&Branch&"PricingParameters",8,1),5));
            data_options: saveCalculatedValue,unscalable;
            fixed_decimals: 2;
            title: "Duration Maximum average";
            visible: 1;
            options_title: locked;
          }
          variable MinimumPD
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(MinimumPD_FIXED), MinimumPD_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls",&Branch&"PricingParameters",9,1),0.0003));
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 4;
            title: "Minimum PD";
            visible: 1;
            options_title: locked;
          }
          variable MaxPD
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(MaxPD_FIXED), MaxPD_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls",&Branch&"PricingParameters",10,1),0.75));
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 4;
            title: "Maximum PD";
            visible: 1;
            options_title: locked;
          }
          variable Correlation
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(Correlation_FIXED), Correlation_FIXED, 0.12*(1-EXP(-50*PD))/(1-EXP(-50))+0.24*((1-(1-EXP(-50*PD))/(1-EXP(-50)))) );
            data_options: saveCalculatedValue,unscalable;
            fixed_decimals: 2;
            title: "Correlation";
            visible: 1;
            options_title: locked;
          }
          variable CostOfFundingPerc
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(CostOfFundingPerc_FIXED), CostOfFundingPerc_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls",&Branch&"PricingParameters",11,1),NA));
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "Cost of Funding";
            visible: 1;
            options_title: locked;
          }
          variable CureRate
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(CureRate_FIXED), CureRate_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls","LGDparameters",Branchselection,1),NA));
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "CureRate";
            visible: 1;
            options_title: locked;
          }
          variable UnsecuredRecoveryRate
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(UnsecuredRecoveryRate_FIXED), UnsecuredRecoveryRate_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls","LGDparameters",Branchselection,2),NA));
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "UnsecuredRecoveryRate";
            visible: 1;
            options_title: locked;
          }
          variable IndirectCost
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(IndirectCost_FIXED), IndirectCost_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls","LGDparameters",Branchselection,3),NA));
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "IndirectCost";
            visible: 1;
            options_title: locked;
          }
          variable AverageTimeDefault
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(AverageContractRate_FIXED), AverageContractRate_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls","LGDparameters",Branchselection,4),NA));
            data_options: saveCalculatedValue,unscalable;
            fixed_decimals: 2;
            title: "AverageTimeDefault";
            visible: 1;
            options_title: locked;
          }
          variable AverageContractRate
          {
            datatype: number;
            frequency: document;
            formula: If(DataEntered(AverageTimeDefault_FIXED), AverageTimeDefault_FIXED,OnERorNA(MatrixLookup("TRIODOS_Parameters.xls","LGDparameters",Branchselection,5),NA));
            data_options: saveCalculatedValue,unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "AverageContractRate";
            visible: 1;
            options_title: locked;
          }
        }
        variable AssumptionsFixed
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Assumptions (FIXED)";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
          variable Branch_FIXED
          {
            datatype: string;
            frequency: document;
            data_options: unscalable;
            title: "Branch";
            top_blanklines: 1;
            locked: 1;
            visible: 1;
            options_title: locked;
            options: locked;
          }
          variable ConfidenceLevel_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "Confidence Level";
            visible: 1;
            options_title: locked;
          }
          variable HurdleRate_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "Hurdle rate";
            visible: 1;
            options_title: locked;
          }
          variable RendementseisBank_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "Targert return on equity";
            visible: 1;
            options_title: locked;
          }
          variable Taxrate_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "Tax rate";
            visible: 1;
            options_title: locked;
          }
          variable ProcessCostsModelPercentage_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "Process cost";
            visible: 1;
            options_title: locked;
          }
          variable LGDMaximum_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "LGD Maximum";
            visible: 1;
            options_title: locked;
          }
          variable LGDMinimum_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "LGD Minimum";
            visible: 1;
            options_title: locked;
          }
          variable DurationMaximumAverage_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            fixed_decimals: 2;
            title: "Duration Maximum average";
            visible: 1;
            options_title: locked;
          }
          variable MinimumPD_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 4;
            title: "Minimum PD";
            visible: 1;
            options_title: locked;
          }
          variable MaxPD_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 4;
            title: "Maximum PD";
            visible: 1;
            options_title: locked;
          }
          variable Correlation_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            fixed_decimals: 2;
            title: "Correlation";
            visible: 1;
            options_title: locked;
          }
          variable CostOfFundingPerc_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "Cost of Funding";
            visible: 1;
            options_title: locked;
          }
          variable CureRate_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "CureRate";
            visible: 1;
            options_title: locked;
          }
          variable UnsecuredRecoveryRate_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "UnsecuredRecoveryRate";
            visible: 1;
            options_title: locked;
          }
          variable IndirectCost_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "IndirectCost";
            visible: 1;
            options_title: locked;
          }
          variable AverageTimeDefault_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            fixed_decimals: 2;
            title: "AverageTimeDefault";
            visible: 1;
            options_title: locked;
          }
          variable AverageContractRate_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 3;
            title: "AverageContractRate";
            visible: 1;
            options_title: locked;
          }
          variable PD_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 4;
            title: "Rating (Used)";
            visible: 1;
            options_title: locked;
          }
          variable IMPORT_PD_FIXED
          {
            datatype: number;
            frequency: document;
            data_options: unscalable;
            displaytype: percentage;
            fixed_decimals: 4;
            title: "Rating (Calculated)";
            visible: 1;
            options_title: locked;
          }
          variable Q_MATRIXVERSION_FIXED
          {
            datatype: string;
            frequency: document;
            data_options: unscalable;
            title: "Matrix version";
            visible: 1;
            options_title: locked;
          }
          variable Q_MODELVERSION_FIXED
          {
            datatype: string;
            frequency: document;
            data_options: unscalable;
            title: "Model version";
            visible: 1;
            options_title: locked;
          }
        }
        variable Q_MAP00_HULPVARIABELEN
        {
          datatype: number;
          frequency: document;
          displaytype: currency;
          title: "Hulpvariabelen";
          locked: 1;
          visible: 0;
          options_title: locked;
          options: locked;
          variable Q_MAP00_REQUIREDVARS
          {
            datatype: number;
            frequency: document;
            formula: 1;
            displaytype: currency;
            title: "Aantal verplichte velden (1)";
            top_blanklines: 1;
            locked: 1;
            visible: 0;
            options_title: locked;
            options: locked;
          }
          variable Q_MAP00_ENTEREDREQUIREDVARS
          {
            datatype: number;
            frequency: document;
            formula: 1;
            displaytype: currency;
            title: "Aantal ingevulde verplichte velden (1)";
            locked: 1;
            visible: 0;
            options_title: locked;
            options: locked;
          }
        }
      }
      variable Q_RESULT
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "Results";
        top_blanklines: 1;
        locked: 1;
        visible: 1;
        options_title: locked;
        options: locked;
        variable Q_RESULTSUB1 refers to Q_RESULT
        {
          datatype: string;
          frequency: document;
          data_options: unscalable;
          title: "Results";
          top_blanklines: 1;
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
      }
      variable Q_STATUS
      {
        datatype: number;
        frequency: document;
        formula: 0;
        data_options: saveCalculatedValue,unscalable;
        displaytype: select;
        title: "Status";
        top_blanklines: 1;
        visible: 1;
        choices: "0:Open|1:Final";
        options_title: locked;
      }
      variable Q_STATUS_FINAL_ON
      {
        datatype: number;
        frequency: document;
        data_options: unscalable;
        afterinput: execute((SetValue(PD_FIXED, PD, true)),(SetValue(IMPORT_PD_FIXED , IMPORT_PD, true)),(SetValue(Facility_tpPD_FIXED, Facility_tpPD, true)),(SetValue(Facility_tpProductInterestRateFunding_FIXED, Facility_tpProductInterestRateFunding, true)),(SetValue(ConfidenceLevel_FIXED, ConfidenceLevel, true)),(SetValue(Branch_FIXED, Branch, true)),(SetValue(LGDMaximum_FIXED, LGDMaximum, true)),(SetValue(LGDMinimum_FIXED, LGDMinimum, true)),(SetValue(HurdleRate_FIXED, HurdleRate, true)),(SetValue(RendementseisBank_FIXED, RendementseisBank, true)),(SetValue(Taxrate_FIXED, Taxrate, true)),(SetValue(ProcessCostsModelPercentage_FIXED, ProcessCostsModelPercentage, true)),(SetValue(DurationMaximumAverage_FIXED, DurationMaximumAverage, true)),(SetValue(MinimumPD_FIXED, MinimumPD, true)),(SetValue(MaxPD_FIXED, MaxPD, true)),(SetValue(Correlation_FIXED, Correlation, true)),(SetValue(Q_MATRIXVERSION_FIXED, Q_MATRIXVERSION, true)),(SetEnteredValue(Q_MODELVERSION_FIXED, Q_MODELVERSION, true)),(SetValue(CostOfFundingPerc_FIXED, CostOfFundingPerc, true)),(SetValue(CureRate_FIXED, CureRate, true)),(SetValue(UnsecuredRecoveryRate_FIXED, UnsecuredRecoveryRate, true)),(SetValue(IndirectCost_FIXED, IndirectCost, true)),(SetValue(AverageTimeDefault_FIXED, AverageTimeDefault, true)),(SetValue(AverageContractRate_FIXED, AverageContractRate, true)));
        displaytype: date;
        title: "Made final on:";
        visible: 1;
        options_title: locked;
      }
      variable Q_STATUS_FINAL_BY
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "Made final by:";
        visible: 1;
        options_title: locked;
      }
      variable Q_STATUS_STARTED_ON
      {
        datatype: number;
        frequency: document;
        data_options: unscalable;
        displaytype: date;
        title: "Created on:";
        visible: 1;
        options_title: locked;
      }
      variable Q_STATUS_STARTED_BY
      {
        datatype: string;
        frequency: document;
        data_options: unscalable;
        title: "Created by:";
        visible: 1;
        options_title: locked;
      }
      variable Q_STATUS_MODIFIED_ON
      {
        datatype: number;
        frequency: document;
        formula: Now;
        data_options: saveCalculatedValue,unscalable;
        displaytype: date;
        title: "Last modification:";
        visible: 1;
        options_title: locked;
      }
      variable Q_MODELVERSION
      {
        datatype: string;
        frequency: document;
        formula: "02.00.001.008";
        data_options: saveCalculatedValue,unscalable;
        title: "Model version";
        locked: 1;
        visible: 1;
        options_title: locked;
        options: locked;
      }
      variable Q_MODELTYPE
      {
        datatype: string;
        frequency: document;
        formula: "PRICING";
        data_options: saveCalculatedValue,unscalable;
        title: "Model type";
        locked: 1;
        visible: 1;
        options_title: locked;
        options: locked;
      }
      variable Q_MATRIXVERSION
      {
        datatype: string;
        frequency: document;
        formula: EvaluateAsString(MatrixLookup("TRIODOS_Parameters.xls","Version",1,3));
        data_options: saveCalculatedValue,unscalable;
        title: "Matrix version";
        locked: 1;
        visible: 1;
        options_title: locked;
        options: locked;
      }
      variable Q_PREVIOUS_BUTTON_VISIBLE
      {
        datatype: number;
        frequency: document;
        formula: 2;
        data_options: unscalable;
        displaytype: select;
        title: "Previous";
        visible: 1;
        choices: "0:Nooit|2:Altijd";
        options_title: locked;
      }
      variable Q_NEXT_BUTTON_VISIBLE
      {
        datatype: number;
        frequency: document;
        formula: 2;
        data_options: unscalable;
        displaytype: select;
        title: "Next";
        visible: 1;
        choices: "0:Nooit|1:Alleen wanneer stap volledig is|2:Altijd";
        options_title: locked;
      }
      variable Q_CONCEPT_REPORT_VISIBLE
      {
        datatype: number;
        frequency: document;
        formula: 0;
        data_options: unscalable;
        displaytype: select;
        title: "Draft report";
        visible: 1;
        choices: "0:Nee|1:Ja";
        options_title: locked;
      }
      variable Q_FINAL_REPORT_VISIBLE
      {
        datatype: number;
        frequency: document;
        formula: 0;
        data_options: unscalable;
        displaytype: select;
        title: "Final report";
        visible: 1;
        choices: "0:Nee|1:Ja";
        options_title: locked;
      }
      variable Q_MAKE_FINAL_VISIBLE
      {
        datatype: number;
        frequency: document;
        formula: 1;
        data_options: unscalable;
        displaytype: select;
        title: "Make it final";
        visible: 1;
        choices: "0:Nee|1:Ja";
        options_title: locked;
      }
    }
    variable Hulpvariabelen
    {
      datatype: none;
      frequency: none;
      title: "Overige berekeningen";
      top_blanklines: 1;
      locked: 1;
      visible: 0;
      options_title: locked;
      options: locked, invisible;
      variable Q_WARNING_GLOBAL
      {
        datatype: string;
        frequency: document;
        formula: EvaluateAsString(If(Length(&scKnockoutsCombi[1])>0,&"\r\nEr zijn knockouts van toepassing:"&scKnockoutsCombi,""));
        data_options: unscalable;
        displaytype: memo;
        title: "Knockout(s)?";
        top_blanklines: 1;
        locked: 1;
        visible: 1;
        options_title: locked;
        options: locked;
        variable scKnockoutsCombi
        {
          datatype: string;
          frequency: document;
          data_options: unscalable;
          displaytype: memo;
          title: "Knockouts tekst";
          top_blanklines: 1;
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
        variable Q_GLOBAL_VALIDATION
        {
          datatype: string;
          frequency: document;
          formula: EvaluateAsString(If((&Q_MODELVERSION_FIXED < "02.00.000.000") and (Q_STATUS=1), &"Attention: This scorecard has been made final with version "&Q_MODELVERSION_FIXED&" of pricing. The current pricing version is "&Q_MODELVERSION&".", &""));
          data_options: unscalable;
          displaytype: memo;
          title: "Knockouts tekst";
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
      }
      variable scRestricties
      {
        datatype: string;
        frequency: document;
        formula: EvaluateAsString(If(Length(&scRestrictiesCombi[1])>0,&"\r\n\r\nDe volgende variabelen zijn niet correct gevuld:"&scRestrictiesCombi,""));
        data_options: unscalable;
        displaytype: memo;
        title: "Restricties";
        locked: 1;
        visible: 1;
        options_title: locked;
        options: locked;
        variable scRestrictiesCombi
        {
          datatype: string;
          frequency: document;
          data_options: unscalable;
          displaytype: memo;
          title: "Restricties tekst";
          top_blanklines: 1;
          locked: 1;
          visible: 1;
          options_title: locked;
          options: locked;
        }
      }
      variable COMPLETE
      {
        datatype: number;
        frequency: document;
        formula: If( Q_ROOT=1,1,0);
        data_options: unscalable;
        fixed_decimals: 0;
        title: "COMPLETE";
        locked: 1;
        visible: 1;
        options_title: locked;
        options: locked;
      }
      variable ShowHiddenFields
      {
        datatype: number;
        frequency: document;
        formula: If( Pos("Tester",&RatingMemo[1])>0 ,1,0);
        data_options: unscalable;
        fixed_decimals: 0;
        title: "Show Hidden fields";
        locked: 1;
        visible: 1;
        options_title: locked;
        options: locked;
      }
    }
  }
}
